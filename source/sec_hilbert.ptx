<section xml:id="sec_hilbert">
  <title>The Hilbert class field</title>
  <introduction>
    <paragraphs>
      <title>Reference</title>
      <p>
        <xref ref="bib-Milne-CFT"/>, Introduction; <xref ref="bib-Neukirch"/>, VI.6.
      </p>
    </paragraphs>
  </introduction>
  <subsection>
    <title>An example of an unramified extension</title>
    <p>
      Recall that the field <m>\QQ</m> has no extensions which are everywhere unramified (<xref ref="T_Minkowski"/>).
      This is quite definitely not true of other number fields; we begin with an example illustrating this.
    </p>
    <example xml:id="ex-unramified">
      <title>An unramified extension of a number field</title>
      <p>
        In the number field <m>K = \QQ(\sqrt{-5})</m>,
        the ring of integers is <m>\ZZ[\sqrt{-5}]</m> and the ideal <m>(2)</m> factors as <m>\gothp^2</m>,
        where the ideal <m>\gothp = (2, 1 + \sqrt{-5})</m> is not principal.
      </p>
      <p>
        Now let's see what happens when we adjoin a square root of <m>-1</m>,
        obtaining <m>L = \QQ(\sqrt{-5}, \sqrt{-1})</m>.
        The extension <m>\QQ(\sqrt{-1})/\QQ</m> only ramifies over 2, so <m>L/K</m> can only be ramified over <m>\gothp</m>.
        On the other hand, if we write
        <m>L = K(\alpha)</m> where <m>\alpha = (1 + \sqrt{5})/2</m>,
        then modulo <m>\gothp</m> the minimal polynomial <m>x^2-x-1</m> of <m>\alpha</m> remains irreducible,
        so <m>\gothp</m> is unramified
        (and not split)
        in <m>L</m>.
      </p>
    </example>
  </subsection>
  <subsection>
    <title>Hilbert class fields</title>
    <p>
      We've now seen that <m>\QQ(\sqrt{-5})</m> admits both a nonprincipal ideal and an unramified abelian extension.
      It turns out these are not unrelated events.
    </p>
    <definition>
      <title>Jargon watch</title>
      <p>
        In class field theory, the phrase <q><m>L/K</m> is unramified</q> is conventionally interpreted to mean that
        <m>L/K</m> is unramified over all finite places in the usual sense,
        <em>and</em> that every real embedding of <m>K</m> extends to a real embedding of <m>L</m>.
      </p>
    </definition>
    <theorem xml:id="T_Hilbert_class_field">
      <statement>
        <p>
          Let <m>L</m> be the maximal unramified abelian extension of a number field <m>K</m>.
          Then <m>L/K</m> is finite,
          and its Galois group is isomorphic to the ideal class group <m>\Cl(K)</m> of <m>K</m>.
          The field <m>L</m> is called the <term>Hilbert class field</term> of <m>K</m>.
        </p>
      </statement>
      <proof>
        <p>
          A canonical isomorphism will be given by the Artin reciprocity law (<xref ref="T-Artin-reciprocity"/>).
        </p>
      </proof>
    </theorem>
    <remark>
      <p>
        While <xref ref="T_Hilbert_class_field"/> implies that an abelian unramified extension must be finite,
        there can be infinite unramified <em>nonabelian</em> extensions.
        See <xref ref="R-class-field-towers"/>.
      </p>
    </remark>
    <remark>
      <p>
        At this point, it should now be apparent that <term>class field theory</term> is <q>class field</q> theory, i.e., the theory of <term>class fields</term> such 
        as the Hilbert class fields (and other examples described in <xref ref="def-ray-class-field"/>) rather than a special type of <q>field theory</q>. Whether this
        affects your pronunciation of the entire phrase is up to you!
      </p>
    </remark>
  </subsection>
  <exercises>
    <title>Exercises</title>
    <exercise xml:id="exer-genus-theory">
      <statement>
        <p>
          Let <m>K</m> be an imaginary quadratic extension of <m>\QQ</m> in which <m>t</m> finite primes ramify.
          Assuming <xref ref="T_Hilbert_class_field"/>,
          prove that <m>\#(\Cl(K)/2\Cl(K)) = 2^{t-1}</m>;
          this recovers a theorem of Gauss originally proved using binary quadratic forms.
        </p>
      </statement>
      <hint>
        <p>
          Let <m>H_2</m> be the subfield of the Hilbert class field of <m>K</m> generated by quadratic subextensions,
          so that <m>\Gal(H_2/K) \cong \Cl(K)/2\Cl(K)</m>. 
          Check that the action of the nontrivial automorphism of <m>K</m> fixes
          <m>\Cl(K)/2\Cl(K)</m>, then deduce that <m>H_2</m> is not only Galois, but in fact <em>abelian</em> over <m>\QQ</m>.
          In particular, any quadratic subextension <m>L/K</m> of <m>H_2/K</m> is Galois over <m>\QQ</m>;
          show next that <m>\Gal(L/\QQ)</m> cannot be cyclic. (At least one prime of <m>L</m> ramifies over <m>\QQ</m>;
          for any such prime, the inertia field is a subfield of <m>L/\QQ</m> not equal to any of <m>\QQ,K,L</m>.)
        </p>
        <p>
          Conclude from this that any quadratic unramified extension of <m>K</m> must be the compositum with a quadratic extension of <m>\QQ</m>.
          Then show that this quadratic extension must be ramified only above primes that ramify in <m>K</m>,
          and count the number of such extensions.
        </p>
      </hint>
    </exercise>
    <exercise>
      <statement>
        <p>
          Give an example, using a real quadratic field, to illustrate that:
          <ol>
            <li>
              <xref ref="T_Hilbert_class_field"/> fails if we don't require the extensions to be unramified above the real place;
            </li>
            <li>
              <xref ref="exer-genus-theory"/> fails for real quadratic fields. (See also <xref ref="exer-genus-theory-narrow"/>.)
            </li>
          </ol>
        </p>
      </statement>
    </exercise>
    <exercise xml:id="exer-genus-theory-narrow">
      <statement>
        <p>
          Prove that <xref ref="exer-genus-theory"/> extends to real quadratic fields if one replaces the class group by the
          <term>narrow class group</term>,
          in which you only mod out by principal ideals having a totally positive generator.
          This gives an example of a <term>ray class group</term>;
          more on those in <xref ref="sec_artinrec"/>.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          The field <m>\QQ(\sqrt{-23})</m> admits an ideal of order 3 in the class group and an unramified abelian extension of degree 3.
          Find both.
        </p>
      </statement>
      <hint>
        <p>
          The unramified abelian extension contains a cubic number field of discriminant -23.
          Compare <xref ref="exer-unramified-An"/>.
        </p>
      </hint>
    </exercise>
    <exercise xml:id="exer-relative-class1">
      <statement>
        <p>
          Let <m>L/K</m> be an extension of number fields admitting no nontrivial abelian subextension <m>M/K</m> which is everywhere
          unramified (including at archimedean places). Assuming <xref ref="T_Hilbert_class_field"/>, prove
          that the class number of <m>K</m> divides the class number of <m>L</m>.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          A number field <m>K</m> is called a <term>CM field</term> if it is a totally complex quadratic extension of a totally real number field
          <m>K_+</m>. Using <xref ref="exer-relative-class1"/>, show that the class number of <m>K_+</m> divides the class number of <m>K</m>. The ratio is 
          called the <term>relative class number</term>.
        </p>
      </statement>
    </exercise>
    <exercise xml:id="exer-unramified-An">
      <statement>
        <p>
          Let <m>P(x) \in \ZZ[x]</m> be a polynomial whose discriminant <m>D</m> is squarefree (and hence odd).
          <ol>
            <li>
              Prove that the field <m>K = \QQ[x]/(P(x))</m> has Galois group <m>S_n</m> over <m>\QQ</m>.
            </li>
            <li>
              Prove that the Galois closure of <m>K/\QQ</m> is unramified over all finite places of <m>\QQ(\sqrt{D})</m>.
            </li>
          </ol>
          This gives an ample supply
          of everywhere unramified extensions (of various fields) which are nonabelian for <m>n \gt 3</m>, and nonsolvable for <m>n \gt 4</m>.
        </p>
      </statement>
      <hint>
        <p>
          We follow an argument of Yamamoto (<xref ref="bib-Yamamoto"/>, p. 69, proof of Proposition 1).
          Let <m>M</m> be the Galois closure of <m>K/\QQ</m>.
          Recall that <m>M/K</m> is unramified over a prime <m>\gothp</m> of <m>K</m> if and only if <m>L/K</m> is:
          if the decomposition group of some (hence any) prime of <m>M</m> above <m>\gothp</m> is nontrivial, then I can choose that prime so that the decomposition group
          is not contained in <m>\Gal(M/K)</m>.
          Next, note that for each odd prime <m>p</m> dividing <m>K</m>, there is a unique prime <m>\gothp</m> above <m>p</m>
          which is ramified with ramification index 2.
          Finally, using the different to compute the discriminant, show that <m>L</m> also has a unique
          prime ramified over <m>p</m> and that the ramification index is again 2, then deduce that this prime cannot ramify over <m>\gothp</m>.
          (This also shows that the decomposition group has order 2, so the Galois group is a transitive subgroup of <m>S_n</m> containing a transposition.)
        </p>
      </hint>
    </exercise>
    <exercise>
      <statement>
        <p>
          Show that the conclusion of <xref ref="exer-unramified-An"/> remains true if we only require <m>K</m>
          to be a number field of degree <m>n</m> with Galois group <m>S_n</m> whose discriminant <m>D</m> is squarefree, 
          but not necessarily of the form <m>\QQ[x]/(P(x))</m> where <m>P(x) \in \ZZ[x]</m> has discriminant <m>D</m>.
          This even holds when <m>D</m> is not squarefree but is the discriminant of a quadratic number field; see <xref ref="bib-Kondo"/>.
        </p>
      </statement>
      <hint>
        <p>
          First show that if there are two distinct primes of <m>L</m> that ramify over <m>p</m>, then <m>p^2</m> must divide <m>D</m>.
          Then use the fact that <m>L</m> is <em>locally</em> monogenic at the unique ramified prime over <m>p</m> to emulate
          the solution of <xref ref="exer-unramified-An"/>.
        </p>
      </hint>
    </exercise>
    <exercise>
      <statement>
        <p>
          Let <m>D</m> be a squarefree integer divisible by at least three distinct primes.
          Prove that <m>\Cl(\QQ(\sqrt{D}))</m> is nontrivial.
        </p>
      </statement>
      <hint>
        <p>
          Use the prime factors of <m>D</m> to produce an everywhere unramified quadratic extension.
        </p>
      </hint>
    </exercise>
  </exercises>
</section>
