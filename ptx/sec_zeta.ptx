<section xml:id="sec_zeta">
  <title>Zeta functions and the Chebotar&#xeb;v density theorem</title>
  <introduction>
    <paragraphs>
      <title>Reference</title>
      <p>
        <xref ref="bib-Lang"/>, Chapter VIII for starters;
        see also <xref ref="bib-Milne-CFT"/>, Chapter VI and <xref ref="bib-Neukirch"/>, Chapter VII. For advanced reading,
        see Tate's thesis (last chapter of <xref ref="bib-Cassels-Frohlich"/>),
        but wait until we introduce the ad&#xe8;les (<xref ref="sec_adeles"/>).
      </p>
    </paragraphs>
  </introduction>
  <subsection>
    <title>The Dedekind zeta function of a number field</title>
    <p>
      Although this is supposed to be a course on algebraic number theory,
      the following analytic discussion is so fundamental that we must at least allude to it here.
    </p>
    <definition>
      Let <m>K</m> be a number field.
      The <term>Dedekind zeta function</term> <m>\zeta_K(s)</m> is a function on the complex plane given,
      for <m>\Real(s) > 1</m>, by the absolutely convergent product and sum
      <me>
        \zeta_K(s) = \prod_\gothp (1 - \Norm(\gothp)^{-s})^{-1} = \zeta_K(s) = \sum_{\gotha} \Norm(\gotha)^{-s}
      </me>
      where <m>\gothp</m> runs over the nonzero prime ideals of <m>\gotho_K</m> 
      and <m>\gotha</m> runs over the nonzero ideals of <m>\gotho_K</m>.
    </definition>
    <p>
      A fundamental fact about the zeta function is the following.
      We omit the proof.
    </p>
    <theorem xml:id="T_meromorphic_continuation">
      <statement>
        <p>
          The function <m>\zeta_K(s)</m> extends to a meromorphic function on <m>\CC</m> whose only pole is a simple pole at <m>s=1</m> of residue <m>1</m>.
        </p>
      </statement>
    </theorem>
    <p>
      The case <m>K=\QQ</m> is of course the famous Riemann zeta function.
      There is also a functional equation relating the values of <m>\zeta_K</m> at <m>s</m> and <m>1-s</m>,
      and an extended Riemann hypothesis: aside from
      <q>trivial</q>
      zeros along the negative real axis,
      the zeroes of <m>\zeta_K</m> all have real part <m>1/2</m>.
    </p>
  </subsection>
  <subsection>
    <title><m>L</m>-functions of abelian characters</title>
    <definition>
      More generally,
      let <m>\gothm</m> be a formal product of places of <m>K</m>,
      and let <m>\chi_\gothm: \Cl^\gothm(K) \to \CC^*</m> be a character of the ray class group of conductor <m>\gothm</m>.
      Extend <m>\chi_\gothm</m> to a function on all ideals of <m>K</m> by declaring its value to be 0 on ideals not coprime to <m>\gothm</m>.
      Then we define the <term><m>L</m>-function</term>
      <me>
        L(s, \chi_\gothm) = \prod_{\gothp \not| \gothm} (1 - \chi(\gothp) \Norm(\gothp)^{-s})^{-1} = \sum_{(\gotha, \gothm) = 1} \chi(\gotha) \Norm(\gotha)^{-s};
      </me>
      again the product converges absolutely for <m>\Real(s) > 1</m>.
    </definition>
    <p>
      Then we have another basic fact whose proof we also omit.
    </p>
    <theorem xml:id="T_analytic_continuation">
      <statement>
        <p>
          If <m>\chi_\gothm</m> is not trivial,
          then <m>L(s, \chi_\gothm)</m> extends to an analytic function on <m>\CC</m>.
        </p>
      </statement>
    </theorem>
    <p>
      By contrast, if <m>\chi_\gothm</m> is trivial,
      then <m>L(s, \chi_\gothm)</m> is just the Dedekind zeta function with the Euler factors for primes dividing <m>\gothm</m> removed,
      so it still has a pole at <m>s=1</m>.
    </p>
  </subsection>
  <subsection>
    <title>Nonvanishing of <m>L</m>-functions and consequences</title>
    <p>
      One more basic fact, whose proof we again omit, is the following.
    </p>
    <theorem xml:id="T_nonvanishing_of_L">
      <statement>
        <p>
          If <m>\chi_\gothm</m> is not the trivial character,
          then <m>L(1, \chi_\gothm) \neq 0</m>.
        </p>
      </statement>
    </theorem>
    <p>
      For <m>K = \QQ</m>, this is already a nontrivial but important result.
      It implies Dirichlet's famous theorem that there are infinitely many primes in arithmetic progression,
      via the conclusion that for any nontrivial <m>\chi_\gothm</m>,
      <m>\sum_{\gothp} \chi(\gothp) \Norm(\gothp)^{-s}</m> remains bounded as <m>s \to \infty</m>.
      In fact, we say that a set of primes <m>S</m> in a number field <m>K</m> has <term>Dirichlet density</term> <m>d</m> if
      <me>
        \lim_{s \to 1^+} \frac{\sum_{\gothp \in S} \Norm(\gothp)^{-s}}{\log \frac{1}{s-1}} = d
      </me>.
    </p>
    <p>
      Then <xref ref="T_nonvanishing_of_L"/> implies that the Dirichlet density of the set of primes congruent to <m>a</m> modulo <m>m</m>
      is <m>1/\phi(m)</m> if <m>a</m> is coprime to <m>m</m> (and <m>0</m> otherwise).
    </p>
    <p>
      The fact also implies that for any number field <m>K</m> and any formal product of places <m>\gothm</m>,
      there are infinitely many primes in each class of the ray class group of conductor <m>\gothm</m>,
      the set of such primes having Dirichlet density <m>1/\#\Cl^\gothm(K)</m>.
      (See <xref ref="exc-density-of-ray-classes"/>.)
    </p>
  </subsection>
  <subsection>
    <title>The Chebotar&#xeb;v density theorem</title>
    <p>
      Finally, we point out a result of class field theory that also applies to nonabelian extensions.
      Recall that if <m>L/K</m> is any Galois extension of number fields with Galois group <m>G</m>,
      <m>\gothp</m> is a prime of <m>K</m> which does not ramify in <m>L</m>,
      and <m>\gothq</m> is a prime above <m>\gothp</m>,
      then there is a well-defined Frobenius associated to <m>\gothq</m>: it's the element <m>g</m> of the decomposition group
      <m>G_{\gothq}</m> such that <m>x^g \equiv x^{\#(\gotho_K/\gothp)} \pmod{\gothq}</m>.
      Keep in mind thaht as a function of <m>\gothp</m>, this Frobenius is only well-defined up to conjugation in <m>G</m>.
    </p>
    <theorem xml:id="T_Chebotarev">
      <title>Chebotar&#xeb;v density theorem</title>
      <statement>
        <p>
          Let <m>L/K</m> be a Galois extension of number fields with Galois group <m>G</m>.
          Then for any <m>g \in G</m>,
          there exist infinitely many primes <m>\gothp</m> of <m>K</m> such that there is a prime <m>\gothq</m> of <m>L</m> above <m>\gothp</m> with Frobenius <m>g</m>.
          In fact, the Dirichlet density of such primes <m>\gothp</m> is the order of the conjugacy class of <m>G</m> divided by <m>\#G</m>.
        </p>
      </statement>
    </theorem>
    <proof>
      <p>
        This follows from everything we have said so far,
        plus Artin reciprocity, in case <m>L/K</m> is abelian.
        In the general case, let <m>f</m> be the order of <m>g</m>,
        and let <m>K'</m> be the fixed field of <m>g</m>;
        then we know that the set of primes of <m>K'</m> with Frobenius
        <m>g \in \Gal(L/K') \subset G</m> has Dirichlet density <m>1/f</m>.
        The same is true if we restrict to primes of absolute degree 1
        (see exercises).
      </p>
      <p>
        Let <m>Z</m> be the centralizer of <m>g</m> in <m>G</m>;
        that is, <m>Z = \{z \in G: zg = gz\}</m>.
        Then for each prime of <m>K</m> of absolute degree 1)
        with Frobenius in the conjugacy class of <m>g</m>,
        there are <m>\#Z/f</m> primes of <m>K'</m> above it
        (also of absolute degree 1)
        with Frobenius <m>g</m>.
        (Say <m>\gothp</m> is such a prime and <m>\gothq</m> is a prime of <m>L</m> above <m>\gothp</m> with Frobenius <m>g</m>.
        Then for <m>h \in G</m>,
        the Frobenius of <m>\gothq^h</m> is <m>hgh^{-1}</m>,
        so the number of primes <m>\gothq</m> with Frobenius <m>g</m> is <m>\#Z</m>.
        But each prime of <m>L'</m> below one of these is actually below <m>f</m> of them.)
        Thus the density of primes of <m>K</m> with Frobenius in the conjugacy class of <m>g</m> is <m>(1/f)(1/(\#Z/f)) = 1/\#Z</m>.
        To conclude,
        note that the order of the conjugacy class of <m>G</m> is <m>\#G/\#Z</m>.
      </p>
    </proof>
    <corollary xml:id="cor-some-primes-split">
      <statement>
        Let <m>L/K</m> be a nontrivial extension of number fields. Then there exist infinitely many primes of <m>K</m> which do not split completely in <m>L</m>.
      </statement>
      <proof>
        <p>
        Let <m>M/K</m> be the Galois closure of <m>L/K</m>, and set <m>G = \Gal(M/K), H = \Gal(M/L)</m>.
        By hypothesis, <m>G</m> is not the trivial group and the conjugates of <m>H</m> in <m>G</m> have trivial intersection.
        </p>
        <p>
        Let <m>\gothp</m> be any prime of <m>K</m> which does not ramify in <m>M</m> and let <m>\gothq</m> be a prime of <m>M</m> above <m>K</m>.
        Then <m>\gothp</m> splits completely in <m>M</m> if and only if the Frobenius element of <m>\gothq</m> is trivial.
        Moreover, if <m>\gothp</m> splits completely in <m>L</m>, then <m>g</m> lies in every conjugate of <m>H</m> and hence must be trivial,
        so <m>\gothp</m> also splits completely in <m>M</m>. (The converse is also true.)
        </p>
        <p>
        Since <m>G \neq H</m>, we can choose an element <m>g \in G \setminus H</m>. 
        By <xref ref="T_Chebotarev"/>, there exist infinitely many primes <m>\gothp</m>
        of <m>K</m> for which there is a prime <m>\gothq</m> of <m>L</m> above <m>\gothp</m> with Frobenius <m>g</m>.
        By the previous discussion, any such <m>\gothp</m> does not split completely in <m>K</m>.
        </p>
      </proof>
    </corollary>
    <remark>
      <p>
        <xref ref="T_Chebotarev"/> is a special case of a much more general equidistribution conjecture including, among other things,
        the <term>Sato-Tate conjecture</term> on the distribution of Frobenius traces of elliptic curves. See 
        <xref ref="bib-Serre-NXp"/> for an introduction to this circle of ideas.
      </p>
    </remark>
  </subsection>
  <exercises>
    <title>Exercises</title>
      <exercise>
        <statement>
          Show that the Dirichlet density of the set of all primes of a number field is 1.
        </statement>
      </exercise>
      <exercise>
        <statement>
          Show that in any number field,
          the Dirichlet density of the set of primes <m>\gothp</m> of absolute degree greater than 1 is zero.
        </statement>
      </exercise>
      <exercise xml:id="exc-density-of-ray-classes">
        <statement>
          Let <m>\gothm</m> be a formal product of places of the number field <m>K</m>.
          Using <xref ref="T_meromorphic_continuation">Theorems</xref>,
          <xref ref="T_analytic_continuation"></xref>,
          and <xref ref="T_nonvanishing_of_L"></xref>,
          prove that the set of primes of <m>K</m> lying in any specified class of the ray class group of conductor <m>\gothm</m> is <m>1/\#\Cl^\gothm(K)</m>.
        </statement>
        <hint>
          Combine the quantities <m>\sum_{\gothp} \chi(\gothp) \Norm(\gothp)^{-s}</m> to cancel out all but one class.
        </hint>
      </exercise>
      <exercise>
        <statement>
        Let <m>L/K</m> be an extension of number fields. Suppose that for every prime <m>\gothp</m> of <m>K</m> which does not ramify in <m>L</m>,
        all of the primes of <m>L</m> above <m>\gothp</m> have isomorphic residue fields. Using <xref ref="T_Chebotarev"></xref>, prove that <m>L/K</m> is Galois.
        </statement>
        <hint>
        Let <m>M</m> be the Galois closure of <m>L/K</m>.
        Put <m>G = \Gal(M/K)</m> and <m>H = \Gal(M/L)</m>.
        For <m>\gothq</m> a prime of <m>M</m> with decomposition group <m>G_{\gothq}</m> lying above the prime <m>\gothp</m> of <m>K</m>, relate the orders of the
        residue fields of the primes of <m>L</m> to the intersections of <m>G_{\gothq}</m> with the conjugates of <m>H</m> in <m>G</m>
        (see <xref ref="R-decomposition-inertia"/>).
        Use the fact that these conjugates have trivial intersection to deduce that <m>G_{\gothq}</m> must be trivial, and invoke <xref ref="T_Chebotarev"></xref> to conclude.
        </hint>
      </exercise>
      <exercise xml:id="exc-Artin-map-surjective">
        <statement>
          Let <m>L/K</m> be an abelian extension of number fields.
          Using <xref ref="cor-some-primes-split"/>, show that the homomorphism <m>I_K^\gothm \to \Gal(L/K)</m> is surjective.
        </statement>
      </exercise>
      <exercise>
        <statement>
          Let <m>K</m> be a number field and let <m>\gothm</m> be a formal product of places of <m>K</m>.
          Use <xref ref="cor-some-primes-split"/> to show that the ray class field of <m>\gothm</m> is unique.
        </statement>
        <hint>
          Show that if <m>L_1, L_2</m> are both ray class fields of <m>\gothm</m>, then all but finitely many primes of <m>L_1</m> split
          completely in the compositum <m>L_1L_2</m> (namely, those which do not ramify in the compositum).
        </hint>
      </exercise>
  </exercises>
</section>
