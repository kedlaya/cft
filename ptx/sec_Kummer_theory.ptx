<section xml:id="sec_Kummer_theory">
  <title>Kummer theory</title>
  <introduction>
    <paragraphs>
      <title>Reference</title>
      <p>
        Serre, <pubtitle>Local Fields</pubtitle>, Chapter X; Neukirch section IV.3;
        or just about any advanced algebra text (e.g., Lang's <pubtitle>Algebra</pubtitle>).
        The last lemma is from Washington,
        <pubtitle>Introduction to Cyclotomic Fields</pubtitle>, Chapter 14.
      </p>
    </paragraphs>
  </introduction>
  <subsection>
    <paragraphs>
    <title>Jargon watch</title>
    <definition xml:id="D_G-extension">
    <p>
      If <m>G</m> is a group, a <term><m>G</m>-extension</term>
      of a field <m>K</m> is a Galois extension of <m>K</m> with Galois group <m>G</m>.
    </p>
    </definition>
    </paragraphs>
    <p>
      Before attempting to classify all abelian extensions of <m>\QQ_p</m>,
      we recall an older classification result.
      This result will continue to be useful as we proceed to class field theory in general,
      and the technique in its proof prefigures the role to be played by group cohomology down the line.
      So watch carefully!
    </p>
    <p>
      A historical note (due to Franz Lemmermeyer):
      while the idea of studying field extensions generated by radicals was used extensively by Kummer in his work on Fermat's Last Theorem,
      the name <term>Kummer theory</term>
      for the body of results described in this chapter was first applied somewhat later by Hilbert in his <pubtitle>Zahlbericht</pubtitle>,
      a summary of algebraic number theory as of the end of the 19th century.
    </p>
    <theorem xml:id="T_Kummer">
      <statement>
        <p>
          If <m>\zeta_n \in K</m>,
          then every <m>\ZZ/n\ZZ</m>-extension of <m>K</m> is of the form <m>K(\alpha^{1/n})</m> for some
          <m>\alpha \in K^*</m> with the property that
          <m>\alpha^{1/d} \notin K</m> for any proper divisor <m>d</m> of <m>n</m>,
          and vice versa.
        </p>
      </statement>
    </theorem>
    <p>
      Before describing the proof of <xref ref="T_Kummer">Theorem</xref>,
      let me introduce some terminology which marks the tip of the iceberg of group cohomology,
      which we will see more of later.
    </p>
    <definition>
      If <m>G</m> is a group and <m>M</m> is an abelian group on which <m>G</m> acts
      (written multiplicatively),
      one defines the group <m>H^1(G,M)</m> as the set of functions
      <m>f: G \to M</m> such that <m>f(gh) = f(g)^h f(h)</m>,
      modulo the set of such functions of the form
      <m>f(g) = x (x^g)^{-1}</m> for some <m>x \in M</m>.
    </definition>
    <lemma xml:id="L_theorem_90">
      <title>
      <q>Theorem 90</q>
      </title>
      <statement>
        <p>
          Let <m>L/K</m> be a finite Galois extension with Galois group <m>G</m>.
          Then <m>H^1(G, L^*) = 0</m>.
        </p>
      </statement>
    </lemma>
    <p>
      The somewhat unusual common name for this result exists because in the special case where <m>G</m> is cyclic,
      this statement occurs as Theorem (Satz) 90 in Hilbert's <pubtitle>Zahlbericht</pubtitle>.
      The general case first appears in Emmy Noether's 1933 paper on the principal ideal theorem
      (<xref ref="T_principal_ideal_theorem">Theorem</xref>),
      where Noether attributes it to Andreas Speiser.
    </p>
    <proof>
      <p>
        Let <m>f</m> be a function of the form described above.
        By the linear independence of automorphisms
        (see exercises),
        there exists <m>x \in L</m> such that <m>t = \sum_{g \in G} x^g f(g)</m> is nonzero.
        But now
        <me>
          t^h = \sum_{g \in G} x^{gh} f(g)^h = \sum_{g \in G} x^{gh} f(gh) f(h)^{-1} = f(h)^{-1} t
        </me>.
      </p>
      <p>
        Thus <m>f</m> is zero in <m>H^1(G,L^*)</m>.
      </p>
    </proof>
    <p>
    We now prove <xref ref="T_Kummer">Theorem</xref>.
    </p>
    <proof>
      <p>
        On one hand, if <m>\alpha \in K^*</m> is such that
        <m>\alpha^{1/d} \notin K</m> for any proper divisor <m>d</m> of <m>n</m>,
        then the polynomial <m>x^n - \alpha</m> is irreducible over <m>K</m>,
        and every automorphism must have the form
        <m>\alpha \mapsto \alpha \zeta_n^r</m> for some <m>r \in \ZZ/n\ZZ</m>.
        Thus <m>\Gal(K(\alpha^{1/n})/K) \cong \ZZ/n\ZZ</m>.
      </p>
      <p>
        On the other hand, let <m>L</m> be an arbitrary
        <m>\ZZ/n\ZZ</m>-extension of <m>K</m>.
        Choose a generator <m>g \in \Gal(L/K)</m>,
        and let <m>f: \Gal(L/K) \to L^*</m> be the map that sends <m>rg</m> to
        <m>\zeta_n^r</m> for <m>r \in \ZZ</m>.
        Then <m>f \in H^1(\Gal(L/K), L^*)</m>,
        so there exists <m>t \in L</m> such that
        <m>t^{rg}/t = f(rg) = \zeta_n^r</m> for <m>r \in \ZZ</m>.
        In particular, <m>t^n</m> is invariant under <m>\Gal(L/K)</m>,
        so <m>t^n = \alpha</m> for some
        <m>\alpha \in K</m> and <m>L = K(t) = K(\alpha^{1/n})</m>,
        as desired.
      </p>
    </proof>
    <p>
      Another way to state Kummer's theorem is as a bijection
      <me>
        \mbox{\((\ZZ/n\ZZ)^r\)-extensions of \(K\)}  \longleftrightarrow \mbox{\((\ZZ/n\ZZ)^r\)-subgroups of \(K^*/(K^*)^n\)}
      </me>,
      where <m>(K^*)^n</m> is the group of <m>n</m>-th powers in <m>K^*</m>.
      (What we proved above was the case <m>r=1</m>,
      but the general case follows easily.)
      Another way is in terms of the absolute Galois group of <m>K</m>.
      Define the <term>Kummer pairing</term>
      <me>
        \langle \cdot, \cdot \rangle: \Gal(\overline{K}/K) \times K^* \to \{1, \zeta_n, \dots, \zeta_n^{n-1} \}
      </me>
      as follows: given <m>\sigma \in \Gal(\overline{K}/K)</m> and <m>z \in K^*</m>,
      choose <m>y \in \overline{K}^*</m> such that <m>y^n = z</m>,
      and put <m>\langle \sigma, z \rangle = y^\sigma/y</m>.
      Note that this does not depend on the choice of <m>y</m>:
      the other possibilities are
      <m>y \zeta_n^k</m> for <m>k=0, \dots, n-1</m>,
      and <m>\zeta_n^\sigma = \zeta_n</m> by the assumption on <m>K</m>,
      so it drops out.
    </p>
    <theorem xml:id="T_Kummer_reformulated">
      <title>Kummer reformulated</title>
      <statement>
        <p>
          The Kummer pairing induces an isomorphism
          <me>
            K^*/(K^*)^n \to \Hom(\Gal(\overline{K}/K), \ZZ/n\ZZ)
          </me>.
        </p>
      </statement>
    </theorem>
    <proof>
      <p>
        The map comes from the pairing;
        we have to check that it is injective and surjective.
        If <m>y \in K^* \setminus (K^*)^n</m>,
        then <m>K(y^{1/n})</m> is a nontrivial Galois extension of <m>K</m>,
        so there exists some element of
        <m>\Gal(K(y^{1/n})/K)</m> that doesn't preserve <m>y^{1/n}</m>.
        Any lift of that element to
        <m>\Gal(\overline{K}/K)</m> pairs with <m>y</m> to give something other than 1;
        that is, <m>y</m> induces a nonzero homomorphism of <m>\Gal(\overline{K}/K)</m> to <m>\ZZ/n\ZZ</m>.
        Thus injectivity follows.
      </p>
      <p>
        On the other hand, suppose
        <m>f: \Gal(\overline{K}/K) \to \ZZ/n\ZZ</m> is a homomorphism whose image is the cyclic subgroup of <m>\ZZ/n\ZZ</m> of order <m>d</m>.
        Let <m>H</m> be the kernel of <m>f</m>;
        then the fixed field <m>L</m> of <m>H</m> is a
        <m>\ZZ/d\ZZ</m>-extension of <m>K</m> with Galois group <m>\Gal(\overline{K}/K)/H</m>.
        By Kummer theory, <m>L = K(y^{1/d})</m> for some <m>y</m>.
        But now the homomorphisms induced by <m>y^{mn/d}</m>,
        as <m>m</m> runs over all integers coprime to <m>d</m>,
        give all possible homomorphisms of <m>\Gal(\overline{K}/K)/H</m> to <m>\ZZ/d\ZZ</m>,
        so one of them must equal <m>f</m>.
        Thus surjectivity follows.
      </p>
    </proof>
    <p>
      But what about <m>\ZZ/n\ZZ</m>-extensions of a field that does not contains <m>\zeta_{n}</m>?
      These are harder to describe,
      and indeed describing such extensions of <m>\QQ</m> is the heart of this course.
      There is one thing one can say:
      if <m>L/K</m> is a <m>\ZZ/n\ZZ</m>-extension,
      then <m>L(\zeta_n)/K(\zeta_n)</m> is a
      <m>\ZZ/d\ZZ</m> extension for some divisor <m>d</m> of <m>n</m>,
      and the latter is a Kummer extension.
    </p>
    <lemma xml:id="L_Kummer_Galois_criterion">
      <statement>
        <p>
          Let <m>n</m> be a prime
          (or an odd prime power),
          let <m>K</m> be a field of characteristic coprime to <m>n</m>,
          let <m>L = K(\zeta_n)</m>,
          and let <m>M = L(a^{1/n})</m> for some <m>a \in L^*</m>.
          Define the homomorphism <m>\omega: \Gal(L/K) \to (\ZZ/n\ZZ)^*</m> by the relation <m>\zeta_n^{\omega(g)} = \zeta_n^g</m>.
          Then <m>M/K</m> is Galois and abelian if and only if
          <men xml:id="eq">
            a^g / a^{\omega(g)} \in (L^*)^n \qquad \forall g \in \Gal(L/K)
          </men>.
        </p>
      </statement>
    </lemma>
    <p>
      Note that <m>\omega(g)</m> is only defined up to adding a multiple of <m>n</m>,
      so <m>a^{\omega(g)}</m> is only defined up to an <m>n</m>-th power,
      i.e., modulo <m>(L^*)^n</m>.
      (In fact, we will only use one of the implications:
      if <m>M/K</m> is Galois and abelian,
      then <xref ref="eq"/> holds.
      However, we include both implications for completeness.)
    </p>
    <proof>
      <p>
        If <m>a^g/a^{\omega(g)} \in (L^*)^n</m> for all <m>g \in \Gal(L/K)</m>,
        then <m>a</m>,
        <m>a^{\omega(g)}</m> and <m>a^g</m> all generate the same subgroup of <m>(L^*)/(L^*)^n</m>.
        Thus <m>L(a^{1/n}) = L((a^g)^{1/n})</m> for all
        <m>g \in \Gal(L/K)</m>, so <m>M/K</m> is Galois.
        Thus it suffices to assume <m>M/K</m> is Galois,
        then prove that <m>M/K</m> is abelian if and only if <xref ref="eq"/> holds.
        In this case, we must have
        <m>a^g/a^{\rho(g)} \in (M^*)^n</m> for some map <m>\rho: \Gal(L/K) \to (\ZZ/n\ZZ)^*</m>,
        whose codomain is cyclic by our assumption on <m>n</m>.
      </p>
      <p>
        Note that <m>\Gal(M/K)</m> admits a homomorphism <m>\omega</m> to a cyclic group whose kernel <m>\Gal(M/L) \subseteq \ZZ/n\ZZ</m> is also abelian.
        Thus <m>\Gal(M/K)</m> is abelian if and only if <m>g</m> and <m>h</m> commute for any
        <m>g \in \Gal(M/K)</m> and <m>h \in \Gal(M/L)</m>,
        i.e., if <m>h = g^{-1}hg</m>.
        (Since <m>g</m> commutes with powers of itself,
        <m>g</m> then commutes with everything.)
      </p>
      <p>
        Let <m>A \subseteq L^*/(L^*)^n</m> be the subgroup generated by <m>a</m>.
        Then the Kummer pairing gives rise to a pairing
        <me>
          \Gal(M/L) \times A \to \{1, \zeta_{n}, \dots, \zeta_n^{n-1}\}
        </me>
        which is bilinear and nondegenerate,
        so <m>h = g^{-1}hg</m> if and only if
        <m>\langle h, s^g \rangle = \langle ghg^{-1}, s^g \rangle</m> for all <m>s \in A</m>.
        But the Kummer pairing is <term>equivariant</term>
        with respect to <m>\Gal(L/K)</m> as follows:
        <me>
          \langle h,s \rangle^g = \langle g^{-1}hg, s^g \rangle
        </me>,
        because
        <me>
          \left( \frac{(s^{1/n})^h}{s^{1/n}} \right)^g = \frac{((s^g)^{1/n})^{g^{-1}hg}}{(s^g)^{1/n}}
        </me>.
      </p>
      <p>
        (Here by <m>s^{1/n}</m> I mean an arbitrary <m>n</m>-th root of <m>s</m> in <m>M</m>,
        and by <m>(s^g)^{1/n}</m> I mean <m>(s^{1/n})^g</m>.
        Remember that the value of the Kummer pairing doesn't depend on which <m>n</m>-th root you choose.) Thus <m>h = ghg^{-1}</m> if and only if
        <m>\langle h,s^g \rangle = \langle h,s \rangle^g</m> for all <m>s \in A</m>,
        or equivalently, just for <m>s=a</m>.
        But
        <me>
          \langle h,a \rangle^g = \langle h,a \rangle^{\omega(g)} = \langle h, a^{\omega(g)} \rangle
        </me>.
      </p>
      <p>
        Thus <m>g</m> and <m>h</m> commute if and only if <m>\langle h, a^g \rangle = \langle h, a^{\omega(g)}\rangle</m>,
        if and only if
        (by nondegeneracy)
        <m>a^g/a^{\omega(g)} \in (L^*)^n</m>, as desired.
      </p>
    </proof>
   </subsection>
  <exercises>
    <title>Exercises</title>
      <exercise>
        <statement>
          Let <m>n</m> be a positive integer, let <m>K</m> be a field of characteristic coprime to <m>n</m>,
          choose <m>a \in K^*</m>, and put <m>L = K(a^{1/n})</m>. Prove that <m>[K(a^{1/n}):K]</m> divides <m>n</m>.
        </statement>
        <hint>
          Reduce to the case where <m>n</m> is prime. If <m>\zeta_n \in K</m>, use Kummer theory; otherwise,
          consider the Galois closure <m>K(a^{1/n}, \zeta_n)</m> of <m>L/K</m>.
        </hint>
      </exercise>       
      <exercise>
        <statement>
          Prove the linear independence of automorphisms:
          if <m>g_1, \dots,
          g_n</m> are distinct automorphisms of <m>L</m> over <m>K</m>,
          then there do not exist <m>x_1, \dots,
          x_n \in L</m> such that <m>x_1 y^{g_1} + \cdots + x_n y^{g_n} = 0</m> for all <m>y \in L</m>.
        </statement>
        <hint>
          Suppose the contrary,
          choose a counterexample with <m>n</m> as small as possible,
          then make an even smaller counterexample.)
        </hint>
      </exercise>       
      <exercise>
        <statement>
          Prove the additive analogue of <xref ref="L_theorem_90"></xref>:
          if <m>L/K</m> is a finite Galois extension with Galois group <m>G</m>,
          then <m>H^1(G, L) = 0</m>,
          where the abelian group is now the additive group of <m>L</m>.
        </statement>
        <hint>
          By the normal basis theorem
          (see for example Lang, <pubtitle>Algebra</pubtitle>),
          there exists <m>\alpha \in L</m> whose conjugates form a basis of <m>L</m> as a <m>K</m>-vector space.
        </hint>
      </exercise>       
      <exercise>
        <statement>
          Prove the following extension of <xref ref="L_theorem_90"></xref> (also due to Speiser).
          Let <m>L/K</m> be a finite Galois extension with Galois group <m>G</m>.
          Despite the fact that <m>H^1(G, \GL(n,L))</m> does not make sense as a group (because
          <m>\GL(n,L)</m> is not abelian), show nonetheless that
          <q><m>H^1(G, \GL(n,L))</m> is trivial</q>
          in the sense that every function <m>f: G \to \GL(n,L)</m> for which
          <m>f(gh) = f(g)^h f(h)</m> for all <m>g,h \in G</m> can be written as
          <m>x (x^g)^{-1}</m> for some <m>x \in \GL(n,L)</m>.
        </statement>
        <hint>
          To imitate the proof in the case <m>n=1</m>,
          one must find an <m>n \times n</m> matrix <m>x</m> over <m>L</m> such that
          <m>t = \sum_{g \in G} x^g f(g)</m> is not only nonzero but <em>invertible</em>.
          To establish this,
          note that the set of possible values of <m>t</m> on one hand is an <m>L</m>-vector space,
          and on the other hand satisfies no nontrivial <m>L</m>-linear relation.
        </hint>
      </exercise>       
  </exercises>
</section>
