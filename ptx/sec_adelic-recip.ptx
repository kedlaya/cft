<section xml:id="sec_adelic-recip">
  <title>The adelic reciprocity law and Artin reciprocity</title>
  <introduction>
    <p>
      We now describe the setup by which we create a reciprocity law in global class field theory,
      imitating the <q>abstract</q>
      setup from local class field theory but using the id&#xe8;le class group in place of the multiplicative group of the field.
      We then work out why the reciprocity law and existence theorem in the adelic setup imply Artin reciprocity and the existence theorem
      (and a bit more)
      in the classical language.
    </p>
  </introduction>
  <paragraphs>
    <title>Convention note</title>
    <p>
      We are going to fix an algebraic closure
      <m>\overline{\QQ}</m> of <m>\QQ</m>, and regard
      <q>number fields</q>
      as finite subextensions of <m>\overline{\QQ}/\QQ</m>.
      That is, we are fixing the embeddings of number fields into <m>\overline{\QQ}</m>.
      We'll use these embeddings to decide how to embed one number field in another.
    </p>
  </paragraphs>
  <subsection>
    <title>The adelic reciprocity law and existence theorem</title>
    <p>
      Here are the adelic reciprocity law and existence theorem;
      notice that they look just like the local case except that the multiplicative group has been replaced by the id&#xe8;le class group.
    </p>
    <theorem xml:id="T_adelic_reciprocity_law">
      <title>Adelic reciprocity law</title>
      <statement>
        <p>
          There is a canonical map <m>r_K: C_K \to \Gal(K^{\ab}/K)</m> which induces,
          for each Galois extension <m>L/K</m> of number fields,
          an isomorphism <m>r_{L/K}: C_K/\Norm_{L/K} C_L \to \Gal(L/K)^{\ab}</m>.
        </p>
      </statement>
      <proof>
        <p>
          We will first prove an <q>abstract</q> form of this theorem, in which we do not say much about the identity of the map <m>r_K</m>;
          see <xref ref="T_abstract_adelic_reciprocity"/>. We then prove a more precise version including a more specific recipe for the map; see <xref ref="prop-reciprocity-trivial-on-diagonal"/> for the
          recipe and <xref ref="prop-reciprocity-trivial-on-diagonal2"/> for the comparison with the abstract version.
        </p>
      </proof>
    </theorem>
    <theorem xml:id="T_adelic_existence_theorem1">
      <title>Adelic existence theorem</title>
      <statement>
        <p>
          For every number field <m>K</m> and every open subgroup <m>H</m> of <m>C_K</m> of finite index,
          there exists a finite (abelian) extension <m>L</m> of <m>K</m> such that <m>H = \Norm_{L/K} C_L</m>.
        </p>
      </statement>
      <proof>
        <p>
          See <xref ref="T_adelic_existence_theorem2"/>.
        </p>
      </proof>
    </theorem>
    <p>
      We will also obtain a global analogue of the local norm limitation theorem, which was not even suggested by the classical language.
    </p>
    <theorem xml:id="T_adelic_norm_limitation1">
      <title>Adelic norm limitation theorem</title>
      <statement>
        <p>
          Let <m>L/K</m> be an extension of number fields and put <m>M = L \cap K^{\ab}</m>.
          Then <m>\Norm_{L/K} C_L = \Norm_{M/K} C_M</m>.
        </p>
      </statement>
      <proof>
        <p>
          See <xref ref="T_adelic_norm_limitation"/>.
        </p>
      </proof>
    </theorem>
    </subsection>
    <subsection>
      <title>More on the reciprocity map</title>
      <p>
        We next use local class field theory and the principle of <term>local-global compatibility</term> to come up with a candidate for the map <m>r_K</m> in 
        the adelic reciprocity law (<xref ref="T_adelic_reciprocity_law"/>). We note in passing that this principle also lies at the heart of the extension of class field theory envisioned in the 
        Langlands program (<xref ref="rmk-beyond-CFT"/>).
      </p>
    <definition xml:id="def-adelic-reciprocity-candidate">
      <p>
      Let <m>L/K</m> be an abelian extension of number fields and <m>v</m> a place of <m>K</m>.
      Put <m>G = \Gal(L/K)</m> and let <m>G_v</m> be the <term>decomposition group</term> of <m>v</m>, that is,
      the set of <m>g \in G</m> such that <m>v^g = v</m>.
      Then for any place <m>w</m> above <m>v</m>,
      <m>G_v \cong \Gal(L_w/K_v)</m>.
      We will define a map <m>r_{K, v}: K_v^* \to G_v \subseteq G</m> as follows.
      <ul>
        <li>
          <p>
          If <m>v</m> is a finite place, use the local reciprocity map (<xref ref="T_local_reciprocity"/>).
          </p>
        </li>
        <li>
          <p>
          If <m>v</m> is a real place, use the sign map <m>\RR^* \to \{\pm 1\} \cong G_v</m>.
          </p>
        </li>
        <li>
          <p>
          If <m>v</m> is a complex place, then <m>G_v</m> is trivial and so there is nothing left to specify.
          </p>
        </li>
      </ul>
      </p>
      <p>
        Now note that we obtain a well-defined product map
        <me>
        \tilde{r}_K: I_K \to G, \qquad (\alpha_v) \mapsto \prod_v r_{K,v}(\alpha_v):
        </me>i
        for <m>(\alpha_v) \in I_K</m>,
        <m>\alpha_v</m> is a unit for almost all <m>v</m> and <m>L_w/K_v</m> is unramified for almost all <m>v</m> (we may ignore infinite places here).
        For the (almost all) <m>v</m> in both categories,
        <m>r_{K,v}</m> maps <m>\alpha_v</m> to the identity.
      </p>
      <p>
        Since each of the maps <m>r_{K,v}</m> is continuous,
        so is the map <m>\tilde{r}_K</m>.
        That means the kernel of <m>\tilde{r}_K: I_K \to \Gal(L/K)</m> is an open subgroup of <m>I_K</m>.
      </p>
    </definition>
    <p>
      Here is the subtle point, and the real source of <q>reciprocity</q> in this construction.
    </p>
    <proposition xml:id="prop-reciprocity-trivial-on-diagonal">
      <statement>
        <p>
          For <m>L/K</m> an abelian extension of number fields, the map <m>\tilde{r}_K: I_K \to \Gal(L/K)</m> is trivial on <m>K^*</m>.
          It thus factors through a map <m>r_K: C_K \to \Gal(L/K)</m>.
        </p>
      </statement>
      <proof>
        <p>
          See <xref ref="prop-reciprocity-trivial-on-diagonal2"/>.
        </p>
      </proof>
    </proposition>
    <remark xml:id="rmk-cyclotomic-Artin">
      <p>
        In case <m>L = K(\zeta_n)</m> for some <m>n</m>, we can verify <xref ref="prop-reciprocity-trivial-on-diagonal"/> by an explicit computation,
        similar to the direct verification of Artin reciprocity for these extensions. This suggests that in general, we must first prove the adelic existence
        theorem (<xref ref="T_adelic_existence_theorem1"/>) before establishing <xref ref="prop-reciprocity-trivial-on-diagonal"/>. In the interim, we will derive
        a makeshift form of adelic reciprocity from the framework of abstract class field theory.
      </p>
      <p></p>
    </remark>
    <proposition xml:id="prop-deduce-Artin">
      <statement>
        <p>
          Let <m>L/K</m> be an abelian extension of number fields.
          Given <xref ref="T_adelic_reciprocity_law"/> and <xref ref="prop-reciprocity-trivial-on-diagonal"/>,
          let <m>U</m> be the kernel of <m>r_K</m>,
          identify <m>C_K/U</m> with a generalized ideal class group (<xref ref="rmk-open-subgroup-idele"/>) of some conductor <m>\gothm</m>.
          Then the map <m>C_K/U \to \Gal(L/K)</m> is the Artin map; consequently, <xref ref="T-Artin-reciprocity"/> holds.
        </p>
      </statement>
      <proof>
        <p>
          The id&#xe8;le <m>\alpha = (1,1, \dots, \pi, \dots)</m> with a uniformizer <m>\pi</m> of
          <m>\gotho_{K_\gothp}</m> in the <m>\gothp</m> component and 1s elsewhere maps onto the class of <m>\gothp</m> in <m>C_K/U</m>.
          On the other hand, <m>r_K(\alpha) = r_{K, \gothp}(\pi)</m> is
          (because <m>L</m> is unramified over <m>K</m>)
          precisely the Frobenius of <m>\gothp</m>.
          So indeed, <m>\gothp</m> is being mapped to its Frobenius,
          so the map <m>C_K/U \to \Gal(L/K)</m> is indeed Artin reciprocity.
        </p>
      </proof>
    </proposition>
    <remark>
      <p>
        The argument from <xref ref="prop-deduce-Artin"/> also gives some additional information about the Artin map.
        First, the Artin map factors through a generalized ideal class group
        whose conductor <m>\gothm</m> is divisible <em>precisely</em> by the ramified primes
        Second, we can <em>exactly</em> describe the kernel of the classical Artin map: it is generated by
        <ul>
          <li>
            <p>
              all principal ideals congruent to 1 modulo <m>\gothm</m>;
            </p>
          </li>
          <li>
            <p>
              norms of ideals of <m>L</m> not divisible by any ramified primes.
            </p>
          </li>
        </ul>
      </p>
    </remark>
  </subsection>
  <subsection>
    <title>What needs to be done</title>
    <p>
      Many of these steps will be analogous to the steps in local class field theory.
      Notably, we do <em>not</em> directly attempt to verify <xref ref="prop-deduce-Artin"/>
      except for cyclotomic extensions, for which the explicit calculation suggested in <xref ref="rmk-cyclotomic-Artin"/> will be an important input into the machine.
      Instead, we postpone this step all the way until the end; see below.
      <ul>
        <li>
          <p>
            Verify that for <m>L/K</m> cyclic, the Herbrand quotient of <m>C_L</m> as a <m>\Gal(L/K)</m>-module is <m>[L:K]</m>.
            This implies the <term>First Inequality</term> (<xref ref="T_first_inequality"/>):
            <me>
              \#H^0_T(\Gal(L/K), C_L) \geq [L:K].
            </me>
          </p>
        </li>
        <li>
          <p>
            For <m>L/K</m> cyclic, prove the <term>Second Inequality</term> (<xref ref="T_first_and_second_inequality"/>):
            <me>
              \#H^0_T(\Gal(L/K), C_L) \leq [L:K],
            </me>
            which combined with the previous point yields
            <me>
              \#H^0_T(\Gal(L/K), C_L) = [L:K], \qquad \#H^1_T(\Gal(L/K), C_L) = 1.
            </me>
            This step is trivial in local CFT by Theorem 90 (<xref ref="L_theorem_90"/>),
            but is pretty subtle in the global case.
            We will first describe a proof using analytic methods (properties of <m>L</m>-functions); there is also an algebraic approach, more on which below.
          </p>
        </li>
        <li>
          <p>
            Check the conditions for abstract class field theory (<xref ref="sec_abstractcft1"/>) in the setup described at the end of <xref ref="sec_abstractcft3"/>,
            using the previous calculations to establish the class field axiom. 
            Plugging into the machine will then give an <q>abstract</q> reciprocity map (<xref ref="T_abstract_adelic_reciprocity"/>), 
            not yet known to be related to Artin reciprocity except for cyclotomic extensions,
            which are used in the construction of the maps <m>d</m> and <m>v</m>.
          </p>
        </li>
        <li>
          <p>
            Prove the adelic existence theorem (<xref ref="T_adelic_existence_theorem1"/>) by showing that every open subgroup of <m>C_K</m> contains a norm group
            (<xref ref="T_adelic_existence_theorem2"/>).
            This can be done after enlarging <m>K</m>, so we can get into the realm of Kummer theory; this is closely related to the algebraic proof
            of the Second Inequality mentioned above. Note that it is crucial for this step that we have
            the abstract reciprocity map, but not that it be reconciled with Artin reciprocity.
          </p>
        </li>
        <li>
          <p>
            Use the compatibility between the proofs of local and global class field theory to see that the
            <q>abstract</q> global reciprocity map restricts to the usual reciprocity map from local class field theory (<xref ref="prop-reciprocity-trivial-on-diagonal2"/>).
            This will finally imply <xref ref="prop-reciprocity-trivial-on-diagonal"/>, thus yielding the adelic reciprocity map
            (and also showing that it coincides with the abstract reciprocity map).
          </p>
        </li>
        <li>
          <p>
            We will also briefly sketch the approach taken in <xref ref="bib-Milne-CFT"/>,
            in which one uses Galois cohomology in place of abstract class field theory.
            Specifically, one first checks that
            <m>H^2(\Gal(L/K), C_L)</m> is cyclic of order <m>[L:K]</m> in certain
            <q>unramified</q>
            (i.e., cyclotomic) cases; as in the local case,
            one can then deduce this result in general by induction on degree.
            Using Tate's theorem (<xref ref="T_tate_thm1"/>),
            one gets a reciprocity map 
            <me>
              \Gal(L/K)^{\ab} = H^{-2}_T(\Gal(L/K), \ZZ) \to H^0_T(\Gal(L/K), C_K/\Norm_{L/K} C_L)
            </me>
            which again can be reconciled with local reciprocity to get the Artin reciprocity map (<xref ref="prop-reciprocity-trivial-on-diagonal3"/>).
          </p>
        </li>
      </ul>
    </p>
  </subsection>
</section>