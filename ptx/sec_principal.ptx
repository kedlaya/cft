<section xml:id="sec_principal">
  <title>The principal ideal theorem</title>
  <introduction>
    <paragraphs>
      <title>Reference</title>
      <p>
        Milne, section V.3
        (but you won't find the proofs I've omitted there either);
        Neukirch, section VI.7
        (see also IV.5);
        Lang, <pubtitle>Algebraic Number Theory</pubtitle>, section XI.5.
      </p>
    </paragraphs>
    <p>
      For a change, we're going to prove something,
      if only assuming the Artin reciprocity law which we haven't proved.
      Or rather, we're going to sketch a proof that you will fill in by doing the exercises. (Why should I have all the fun?)
    </p>
    <p>
      The following theorem is due to Furtw&#xe4;ngler, a student of Hilbert.
      (It's also called the
      <q>capitulation</q>
      theorem, because in the old days the word
      <q>capitulate</q>
      meant
      <q>to become principal</q>. Etymology left to the reader.)
    </p>
    <theorem xml:id="T_principal_ideal_theorem">
      <title>Principal ideal theorem</title>
      <statement>
        <p>
          Let <m>L</m> be the Hilbert class field of the number field <m>K</m>.
          Then every ideal of <m>K</m> becomes principal in <m>L</m>.
        </p>
      </statement>
    </theorem>
    <p>
      Warning: this does not mean that <m>L</m> has class number 1!
    </p>
    <example>
      if <m>K = \QQ(\sqrt{-5})</m>,
      then <m>L = \QQ(\sqrt{-5}, \sqrt{-1})</m>,
      and the nonprincipal ideal class of <m>K</m> is represented by <m>(2, 1+\sqrt{-5})</m>,
      which is generated by <m>1+\sqrt{-1}</m> in <m>L</m>.
    </example>
    <p>
      The idea is that given Artin reciprocity,
      this reduces to a question in group theory.
      Namely, let <m>M</m> be the Hilbert class field of <m>L</m>;
      then an ideal of <m>L</m> is principal if and only if its image under the Artin map <m>I_L \to \Gal(M/L)</m> is trivial.
      So what we need is to find a map <m>V</m> such that
    </p>
      <figure xml:id="fig-principal-1">
      <image xml:id="img-principal-1">
      <latex-image>
      \xymatrix{
      \Cl(K) \ar[r] \ar[d] &amp; \Gal(L/K) \ar^{V}[d] \\
      \Cl(L) \ar[r] &amp; \Gal(M/L)
      }
      </latex-image>
      </image>
      </figure>
    <p>
      commutes, then show that <m>V</m> is the zero map.
      (The horizontal arrows are the Artin maps.)
    </p>
    <p>
      Regarding the relationship between <m>K</m>, <m>L</m> and <m>M</m>:
      <ol>
        <li>
          <p>
            <m>M</m> is Galois over <m>K</m> (because its image under any element of
            <m>\Gal(\overline{K}/K)</m> is still an abelian extension of <m>L</m> unramified at all finite and infinite places,
            and so is contained in <m>M</m>) and unramified everywhere (since <m>M/L</m> and <m>L/K</m> are unramified);
          </p>
        </li>
        <li>
          <p>
            <m>L</m> is the maximal subextension of <m>M/K</m> which is abelian over <m>K</m>
            (since any abelian subextension is unramified over <m>K</m>,
            and so is contained in <m>L</m>).
          </p>
        </li>
      </ol>
    </p>
    <definition>
      Given a finite group <m>G</m>,
      let <m>G^{\ab}</m> denote the maximal abelian quotient of <m>G</m>;
      that is, <m>G^{\ab}</m> is the quotient of <m>G</m> by its commutator subgroup <m>G'</m>.
      Then (b) implies that <m>\Gal(M/L)</m> is the commutator subgroup of
      <m>\Gal(M/K)</m> and <m>\Gal(M/K)^{\ab} = \Gal(L/K)</m>.
    </definition>
    <p>
      Before returning to the principal ideal theorem,
      we need to do a bit of group theory.
      Let <m>G</m> be a finite group and <m>H</m> a subgroup
      (but not necessarily normal!).
      Let <m>g_1, \dots,
      g_n</m> be left coset representatives of <m>H</m> in <m>G</m>:
      that is, <m>G = g_1H \cup \cdots \cup g_nH</m>.
      For <m>g \in G</m>, put <m>\phi(g) = g_i</m> if
      <m>g \in g_iH</m> (i.e., <m>g_i^{-1}g \in H</m>).
      Put
      <me>
        V(g) = \prod_{i=1}^n \phi(gg_i)^{-1}(gg_i);
      </me>
      then <m>V(g)</m> always lands in <m>H</m>.
      In particular, it induces a map <m>V: G \to H^{\ab}</m>.
    </p>
    <theorem xml:id="T_transfer_homomorphism">
      <statement>
        <p>
          The map <m>V: G \to H^{\ab}</m> is a homomorphism,
          does not depend on the choice of the <m>g_i</m>,
          and induces a homomorphism
          <m>G^{\ab} \to H^{\ab}</m> (i.e., kills commutators in <m>G</m>).
        </p>
      </statement>
    </theorem>
    <definition>
      The map <m>G^{\ab} \to H^{\ab}</m> is called the <term>transfer map</term>
      (in German,
      <q>Verlagerung</q>, hence the <m>V</m>).
    </definition>
    <p>
      Now let's return to that diagram:
    </p>
      <figure xml:id="fig-principal-2">
      <image xml:id="img-principal-2">
      <latex-image>
      \xymatrix{
      \Cl(K) \ar[r] \ar[d] &amp; \Gal(L/K) = \Gal(M/K)^{\ab} \ar^{V}[d] \\
      \Cl(L) \ar[r] &amp; \Gal(M/L) = \Gal(M/L)^{\ab}
      }
      </latex-image>
      </image>
      </figure>
    <p>
      and show that the transfer map <m>V</m> does actually make this diagram commute;
      it's enough to check this when we stick a prime <m>\gothp</m> of <m>K</m> in at the top left.
      For consistency of notation,
      put <m>G = \Gal(M/K)</m> and <m>H = \Gal(M/L)</m>,
      so that <m>G/H = \Gal(L/K)</m>.
      Choose a prime <m>\gothq</m> of <m>L</m> over <m>\gothp</m> and a prime <m>\gothr</m> of <m>M</m> over <m>\gothq</m>,
      let <m>G_{\gothr} \subseteq G</m> be the decomposition group of <m>\gothr</m> over <m>K</m> (i.e., the set of automorphisms mapping <m>\gothr</m> to itself) and let
      <m>g \in G_{\gothr}</m> be the Frobenius of <m>\gothr</m>.
      (Note: since <m>G</m> is not abelian,
      <m>g</m> depends on the choice of <m>\gothr</m>,
      not just on <m>\gothq</m>.
      That is, there's no Artin map into <m>G</m>.)
    </p>
    <p>
      Let <m>\gothq_1, \dots, \gothq_r</m> be the primes of <m>L</m> above <m>\gothp</m>;
      then the image of <m>\gothp</m> in <m>L</m> is <m>\prod_i \gothq_i</m>,
      and the image of that product under the Artin map is <m>\prod_i \Frob_{M/L}(\gothq_i)</m>.
      To show that this equals <m>V(g)</m>,
      we make a careful choice of the coset representatives <m>g_i</m> in the definition of <m>V</m>.
      Namely, decompose <m>G</m> as a union of double cosets <m>G_{\gothr} \tau_i H</m>.
      Then the primes of <m>L</m> above <m>\gothp</m> correspond to these double cosets,
      where the double coset <m>G_{\gothr} \tau_i H</m> corresponds to <m>L \cap \gothr^{\tau_i}</m>.
      Let <m>m</m> be the order of
      <m>\Frob_{L/K}(\gothp)</m> and write <m>G_{\gothr} \tau_i H = \tau_iH \cup g\tau_i H \cup \cdots \cup g^{m-1}\tau_i H</m> for each <m>i</m>;
      we then use the elements <m>g_{ij} = g^j \tau_i</m> as the left coset representatives to define <m>\phi</m> and <m>V</m>.
      Thus the equality <m>V(g) = \prod_i \Frob_{M/L}(\gothq_i)</m> follows from the following lemma.
    </p>
    <lemma xml:id="L_transfer_Frobenius">
      <statement>
        <p>
          If <m>L \cap \gothr^{\tau_i} = \gothq_i</m>,
          then <m>\Frob_{M/L}(\gothq_i) = \prod_{j=0}^{m-1} \phi(g g_{ij})^{-1} g g_{ij}</m>.
        </p>
      </statement>
    </lemma>
    <p>
      Thus the principal ideal theorem now follows from the following fact.
    </p>
    <theorem xml:id="T_transfer_vanishes">
      <statement>
        <p>
          Let <m>G</m> be a finite group and <m>H</m> its commutator subgroup.
          Then the transfer map <m>V: G^{\ab} \to H^{\ab}</m> is zero.
        </p>
      </statement>
    </theorem>
  </introduction>
  <exercises>
    <title>Exercises</title>
      <exercise>
        <statement>
          Prove <xref ref="T_transfer_homomorphism">Theorem</xref>.
        </statement>
        <hint>
          One approach to proving independence from choices is to change one <m>g_i</m> at a time.
          Also, notice that <m>\phi(gg_1), \dots, \phi(gg_n)</m> are a permutation of <m>g_1, \dots, g_n</m>.
        </hint>
      </exercise>
      <exercise>
        <statement>
          Prove <xref ref="L_transfer_Frobenius">Lemma</xref>.
        </statement>
        <hint>
          See Neukirch, Proposition IV.5.9.
        </hint>
      </exercise>
      <exercise>
        <statement>
          With notation as in <xref ref="T_transfer_homomorphism">Theorem</xref>,
          let <m>\ZZ[G]</m> be the group algebra of <m>G</m>
          (formal linear combinations
          <m>\sum_{g \in G} n_g [g]</m> with <m>n_g \in \ZZ</m>,
          multiplied by putting <m>[g][h] = [gh]</m>)
          and let <m>I_G</m> be the ideal of sums
          <m>\sum n_g[g]</m> with <m>\sum n_g = 0</m>
          (called the <term>augmentation ideal</term>;
          see <xref ref="sec_homology">Chapter</xref>).
          Let
          <me>
            \delta: H/H' \to (I_{H}+I_GI_{H})/I_GI_{H}
          </me>
          be the homomorphism taking the class of <m>h</m> to the class of <m>[h]-1</m>.
          Prove that <m>\delta</m> is an isomorphism.
        </statement>
        <hint>
          Show that the elements
          <me>
            [g]([h]-1) \qquad \mbox{for \(g \in \{g_1,\dots,g_n\}, h \in H\)}
          </me>
          form a basis of <m>I_H + I_G I_H</m> as a <m>\ZZ</m>-module.
          For more clues, see Neukirch, Lemma VI.7.7.
        </hint>
      </exercise>
      <exercise>
        <statement>
          With notation as in the previous exercise,
          prove that the following diagram commutes:
      <figure xml:id="fig-principal-3">
      <image xml:id="img-principal-3">
      <latex-image>
      \xymatrix{
      G/G' \ar^{V}[r] \ar^{\delta}[d] &amp; H/H' \ar^{\delta}[d] \\
      I_G/I_G^2 \ar^(.3){S}[r] &amp; (I_{H}+I_GI_{H})/I_GI_{H},
      }
      </latex-image>
      </image>
      </figure>
          where <m>S</m> is given by <m>S(x) = x ([g_1] + \cdots + [g_n])</m>.
        </statement>
      </exercise>
      <exercise>
        <statement>
          Prove <xref ref="T_transfer_vanishes">Theorem</xref>.
        </statement>
        <hint>
          Quotient by the commutator subgroup of <m>H</m> to reduce to the case where <m>H</m> is abelian.
          Apply the classification of finite abelian groups to write <m>G/H</m> as a product of cyclic groups <m>\ZZ/e_1 \ZZ \times \cdots \times \ZZ/e_m \ZZ</m>.
          Let <m>f_i</m> be an element of <m>G</m> lifting a generator of
          <m>\ZZ/e_i \ZZ</m> and put <m>h_i = f_i^{-e_i} \in H</m>;
          then <m>0 = \delta(f_i^{e_i} h_i)</m>,
          which can be rewritten as <m>\delta(f_i) \mu_i</m> for some
          <m>\mu_i \in \ZZ[G]</m> congruent to <m>e_i</m> modulo <m>I_G</m>.
          Now check that
          <me>
            n \mu_1 \cdots \mu_m \equiv [g_1] + \cdots + [g_n] \pmod{I_H \ZZ[G]}
          </me>.
          For more details, see Neukirch, Theorem VI.7.6.
        </hint>
      </exercise>
  </exercises>
</section>
