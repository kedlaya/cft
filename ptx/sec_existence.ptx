<section xml:id="sec_existence">
  <title>The existence theorem</title>
  <paragraphs>
    <title>Reference</title>
    <p>
      Milne VII.9, Neukirch VI.6.
    </p>
  </paragraphs>
  <p>
    With the
    <q>abstract</q>
    reciprocity theorem in hand, we now prove the Existence Theorem,
    that every generalized ideal class group of a number field is identified by Artin reciprocity with the Galois group of a suitable abelian extension.
    Recall that the idelic formulation of this statement is as follows
    (see <xref ref="T_adelic_existence_theorem1">Theorem</xref>).
  </p>
  <theorem xml:id="T_adelic_existence_theorem2">
    <statement>
      <p>
        For <m>K</m> a number field,
        the finite abelian extensions <m>L/K</m> correspond one-to-one with the open subgroups of <m>C_K</m> of finite index,
        via the map <m>L \mapsto \Norm_{L/K} C_L</m>.
      </p>
    </statement>
  </theorem>
  <p>
    The proof of this result is very similar to the proof we gave in the local case.
    For example,
    the reciprocity law immediately lets us reduce to the following proposition.
  </p>
  <proposition>
    <statement>
      <p>
        Every open subgroup <m>U</m> of <m>C_K</m> of finite index contains
        <m>\Norm_{L/K} C_L</m> for some finite extension <m>L</m> of <m>K</m>.
      </p>
    </statement>
  </proposition>
  <p>
    The proof of this proposition again uses Kummer theory,
    but more in the spirit of the algebraic proof of the Second Inequality.
  </p>
  <proof>
    <p>
      We first prove this proposition in case <m>U</m> has prime index <m>p</m>.
      Let <m>J</m> be the preimage of <m>U</m> under the projection <m>I_K \to C_K</m>,
      so that <m>J</m> is open in <m>I_K</m> of finite index.
      Then <m>J</m> contains a subgroup of the form
      <me>
        V = \prod_{v \in S} \{1\} \times \prod_{v \notin S} \gotho_{K_v}^*
      </me>
      for some set <m>S</m> of places of <m>K</m> containing the infinite places and all places dividing <m>(p)</m>,
      which we may choose large enough so that <m>I_{K,S} K^* = I_K</m>.
      Let <m>K_S = K^* \cap I_{K,S}</m> be the group of <m>S</m>-units of <m>K</m>.
    </p>
    <p>
      The group <m>J</m> must also contain <m>I_K^p</m>, so in particular contains
      <me>
        W_S = \prod_{v \in S} (K_v^*)^p \times \prod_{v \notin S} U_v
      </me>.
    </p>
    <p>
      Put <m>C_S = W_S K^*/K^*</m>;
      then <m>C_S \subseteq U</m>,
      so it suffices to show that <m>C_S</m> contains a norm subgroup.
    </p>
    <p>
      If <m>K</m> contains a primitive <m>p</m>-th root of unity,
      then an argument as in the algebraic proof of the Second Inequality gives
      <m>C_{S} = \Norm_{L/K} C_L</m> for <m>L = K(K_S^{1/p})</m>.
      Namely, one first computes that <m>\#C_K/C_S = p^{\#S} = [L:K]</m> as in that proof,
      by reading orders off of the short exact sequence
      <me>
        1 \to K_S / (W_S \cap K_S) \to I_{K,S}/{W_S} \to C_K /C_S \to 1:
      </me>
      on one hand, we have <m>W_S \cap K_S = K_S^p</m>
      (as in the proof of <xref ref="L_adelic_intersection">Lemma</xref>),
      which gives <m>\#K_S/(W_S \cap K_S) = p^{\#S}</m>;
      on the other hand,
      <m>I_{K,S}/W_S</m> is the product of <m>\#S</m> quotients of the form <m>K_v^*/(K_v^*)^p</m>,
      each of which has order <m>p^2</m>
      (generated by a uniformizer and a <m>p</m>-th root of unity,
      since <m>p</m> is prime to the residue characteristic).
    </p>
    <p>
      One then checks that <m>W_S \subseteq \Norm_{L/K} I_L</m> by checking this place by place;
      the places not in <m>S</m> are straightforward
      (they don't ramify in <m>L</m>,
      so local units are local norms),
      and the ones in <m>S</m> follow from the fact that for any local field <m>M</m> containing a <m>p</m>-th root of unity,
      if <m>N = M((M^*)^{1/p})</m>, then
      <me>
        \Norm_{N/M} N^* = (M^*)^p
      </me>,
      which we proved in the course of proving the local existence theorem
      (see <xref ref="L_hilbert_symbol">Lemma</xref>).
      Putting this all together,
      we have <m>C' \subseteq \Norm_{L/K} C_L</m> and these two groups have the same index <m>[L:K]</m> in <m>C_K</m> by the First and Second Inequalities
      (<xref ref="T_first_inequality">Theorem</xref>,
      <xref ref="T_first_and_second_inequality">Theorem</xref>).
    </p>
    <p>
      We next drop the restriction that <m>K</m> contains a <m>p</m>-th root of unity by reducing to the previous case.
      Namely, put <m>K' = K(\zeta_p)</m>.
      For a choice of <m>S</m> as above,
      let <m>S'</m> be the set of places of <m>K'</m> above <m>S</m>;
      we can make <m>S</m> large enough so that <m>I_{K',S'} (K')^* = I_{K'}</m>.
      Then as above,
      <m>C_{S'} = \Norm_{L'/K'} C_{L'}</m> if <m>L'</m> is the extension of <m>K'</m> obtained by adjoining all <m>p</m>-th roots.
      Also as above, <m>\Norm_{K'/K} W_{S'} \subseteq W_S</m>, so
      <me>
        \Norm_{L'/K} C_{L'} = \Norm_{K'/K} (\Norm_{L'/K'} C_{L'}) = \Norm_{K'/K} C_{S'} \subseteq C_S \subseteq U
      </me>.
    </p>
    <p>
      Finally, we handle the case where <m>U</m> has arbitrary index,
      by induction on that index using the above result as the base case.
      If <m>\#C_K/U</m> is not prime,
      choose an intermediate subgroup <m>V</m> between <m>U</m> and <m>C_K</m>.
      By the induction hypothesis,
      <m>V</m> contains <m>N = \Norm_{L/K} C_L</m> for some finite extension <m>L</m> of <m>K</m>.
      Then
      <me>
        \#N / (U \cap N) = \#UN / U \leq \#V/U
      </me>.
    </p>
    <p>
      Let <m>W</m> be the subgroup of <m>C_L</m> consisting of those <m>x</m> whose norms lie in <m>U</m>.
      Then
      <me>
        \#C_L/W \leq \# N/(U \cap N) \leq \#V/U
      </me>,
      so by the induction hypothesis,
      <m>W</m> contains <m>\Norm_{M/L} C_M</m> for some finite extension <m>M/L</m>.
      Thus <m>U</m> contains <m>\Norm_{M/K} C_M</m>, as desired.
    </p>
  </proof>
</section>