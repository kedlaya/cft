<section xml:id="sec_abstractcft">
  <title>Abstract class field theory</title>
  <introduction>
    <paragraphs>
      <title>Reference</title>
      <p>
        Neukirch, IV.4-IV.6.
        Remember that Neukirch's cohomology groups are all Tate groups,
        so he doesn't put the subscript
        <q>T</q>
        on them.
      </p>
    </paragraphs>
    <p>
      We now turn to an alternate method for deriving the main result of local class field theory,
      the local reciprocity law.
      This method, based on a presentation of Artin and Tate,
      makes it clear what the main cohomological inputs are in the local case,
      and gives an outline of how to proceed to global class field theory.
      (Warning: this method does not give information about the local invariant map.)
    </p>
  </introduction>
  <subsection>
    <title>Caveat</title>
    <p>
      We are going to work with the absolute Galois group of a field <m>K</m>,
      i.e., the Galois group of its algebraic closure.
      One could work with a smaller overfield as well.
      In fact, one can go further:
      one really is working with the Galois group and not the fields,
      so one can replace the Galois group by an arbitrary profinite group!
      This is what Neukirch does, but fortunately he softens the blow by
      <q>pretending</q>
      that his profinite group corresponds to a field and its extensions via the Galois correspondence.
      This means you can simply assume that his group <m>G</m> is the absolute Galois group of a field without getting confused.
    </p>
  </subsection>
  <subsection>
    <title>Caveat</title>
    <p>
      Certain words you thought you knew what they meant, such as
      <q>unramified</q>, are going to be reassigned more abstract meanings.
      But these meanings will coincide with the correct definitions over a local field.
    </p>
  </subsection>
  <subsection>
    <title>Abstract ramification theory</title>
    <p>
      Let <m>k</m> be a field,
      <m>\kbar</m> a separable closure of <m>k</m>,
      and <m>G = \Gal(\kbar/k)</m>.
      Let <m>d: G \to \widehat{\ZZ}</m> be a continuous surjective homomorphism.
      The example we have in mind is when <m>k</m> is a local field and <m>d</m> is the surjection of <m>G</m> onto <m>\Gal(k^{\unr}/k) \cong \widehat{\ZZ}</m>.
    </p>
    <p>
      We now make some constructions that, in our example,
      recover information about ramification of extensions of <m>k</m>.
      For starters, define the <em>inertia group</em>
      <m>I_k</m> as the kernel of <m>d</m>,
      and define the <em>maximal unramified extension</em>
      <m>k^{\unr}</m> of <m>k</m> as the fixed field of <m>I_k</m>.
      More generally,
      for any field <m>L</m> between <m>k</m> and <m>\kbar</m>,
      put <m>G_L = \Gal(\kbar/L)</m>,
      put <m>I_L = G_L \cap I_k</m> and let
      <m>L^{\unr}</m> be the fixed field of <m>I_L</m>.
      We say an extension <m>L/K</m> is <em>unramified</em>
      if <m>L \subseteq K^{\unr}</m>.
      Note that this implies that <m>G_L</m> contains <m>I_K</m>,
      necessarily as a normal subgroup,
      and <m>G_L/I_K \subseteq G_K/I_K</m> injects via <m>d</m> into <m>\widehat{\ZZ}</m>;
      thus <m>G_L/I_K</m> is abelian and any finite quotient of it is cyclic.
      In particular,
      <m>G_K</m> is Galois in <m>G_L</m> and <m>\Gal(L/K) = G_L/G_K</m> is cyclic.
      (Note also that <m>K^{\unr}</m> is the compositum of <m>K</m> and <m>k^{\unr}</m>.)
      If <m>K \neq k</m>,
      then <m>d</m> doesn't map <m>G_K</m> onto <m>\widehat{\ZZ}</m>,
      so it will be convenient to renormalize things.
      Put
      <me>
        d_K = \frac{1}{[\widehat{\ZZ}: d(G_K)]}d: G_K \to \widehat{\ZZ};
      </me>
      then <m>d_K</m> is surjective,
      and induces an isomorphism <m>d_K: \Gal(K^{\unr}/K) \to \widehat{\ZZ}</m>.
    </p>
    <p>
      Given a finite extension <m>L/K</m> of fields between <m>k</m> and <m>\kbar</m>,
      define the <em>inertia degree</em>
      (or <em>residue field degree</em>)
      <m>f_{L/K} = [d(G_K):d(G_L)]</m> and the
      <em>ramification degree</em>
      <m>e_{L/K} = [I_K:I_L]</m>.
      By design we have multiplicativity:
      <m>e_{M/K} = e_{M/L}e_{L/K}</m> and <m>f_{M/K} = f_{M/L}f_{L/K}</m>.
      Moreover, if <m>L/K</m> is Galois, we have an exact sequence
      <me>
        1 \to I_K/I_L \to \Gal(L/K) \to d(G_K)/d(G_L) \to 1
      </me>
      so the
      <q>fundamental identity</q>
      holds:
      <me>
        e_{L/K}f_{L/K} = [L:K]
      </me>.
    </p>
    <p>
      The same is true if <m>L/K</m> is not Galois:
      let <m>M</m> be a Galois extension of <m>K</m> containing <m>L</m>,
      then apply the fundamental identity to <m>M/L</m> and <m>M/K</m> and use multiplicativity.
    </p>
  </subsection>
  <subsection>
    <title>Abstract valuation theory</title>
    <p>
      Now suppose that,
      in addition to the field <m>k</m> and the map <m>d: G \to \widehat{\ZZ}</m>,
      we have a <m>G</m>-module <m>A</m>
      (written multiplicatively)
      and a homomorphism <m>v: A^G \to \widehat{\ZZ}</m>.
      We wish to write down conditions that will be satisfied in case <m>k</m> is a local field
      (with <m>d</m> as before, <m>A = \kbar^*</m> and
      <m>v:
      k^* \to \ZZ</m> the valuation of the local field),
      but which will in general give a notion of
      <q>valuation</q>
      on all of <m>A</m>.
    </p>
    <p>
      Given <m>k</m>, <m>d: G \to \widehat{\ZZ}</m>,
      and the <m>G</m>-module <m>A</m>,
      write <m>A_K = A^{G_K} = A^{\Gal(K/k)}</m> for any field <m>K</m> between <m>k</m> and <m>\kbar</m>.
      Also, recall that the norm map
      <m>\Norm_{L/K}: A_L \to A_K</m> is given by <m>\Norm_{L/K}(a) = \prod_g a^g</m>,
      where <m>g</m> runs over a set of right coset representatives of <m>G_K</m> in <m>G_L</m>,
      at least when <m>L</m> is finite.
      (The norm doesn't make sense for an infinite extension,
      but it still makes sense to write
      <m>\Norm_{L/K} A_L</m> to mean the intersection of
      <m>\Norm_{M/K} A_M</m> over all finite subextensions <m>M/K</m> of <m>L</m>.)
    </p>
    <p>
      A <em>henselian valuation</em> of <m>A_k</m> with respect to <m>d</m> is a homomorphism <m>v: A_k \to \widehat{\ZZ}</m> such that:
      <ol>
        <li>
          <p>
            if <m>Z = \im(v)</m>, then <m>Z</m> contains <m>\ZZ</m> and
            <m>Z/nZ \cong \ZZ/n\ZZ</m> for all positive integers <m>n</m>;
          </p>
        </li>
        <li>
          <p>
            <m>v(\Norm_{K/k} A_K) = f_{K/k} Z</m> for all finite extensions <m>K</m> of <m>k</m>.
          </p>
        </li>
      </ol>
    </p>
    <p>
      This valuation immediately extends to a valuation
      <m>v_K: A_K \to Z</m> for all fields <m>K</m> between <m>k</m> and <m>\kbar</m>,
      by setting
      <me>
        v_K = \frac{1}{f_{K/k}} \circ \Norm_{K/k}
      </me>.
    </p>
    <p>
      Then <m>v_{K}(a) = v_{K^g}(a^g)</m> for any <m>a \in A</m> and <m>g \in G</m>,
      and for <m>L/K</m> a finite extension,
      <m>v_K(\Norm_{L/K}(a)) = f_{L/K} v_L(a)</m> for any <m>a \in A_L</m>.
    </p>
    <p>
      For any field <m>K</m> between <m>k</m> and <m>\kbar</m>,
      define the <em>unit subgroup</em>
      <m>U_K</m> as the set of <m>u \in A_K</m> with <m>v_k(u) = 0</m>.
      If <m>K/k</m> is finite,
      we say <m>\pi \in A_K</m> is a <em>uniformizer</em>
      for <m>K</m> if <m>v_K(\pi) = 1</m>.
    </p>
  </subsection>
  <subsection>
    <title>Warning</title>
    <p>
      The multiplicativity of the reciprocity map is proven in Neukirch (Proposition IV.5.5),
      but I find this proof unreadable.
    </p>
    <p>
      Now we bring in the key cohomological input.
      Suppose that for every <em>cyclic</em>
      extension <m>L/K</m> of finite extensions of <m>k</m>,
      <me>
        \#H^i_T(\Gal(L/K), A_L) = \begin{cases}\amp  i=0 \\ 1 \amp  i = -1. \end{cases}
      </me>
    </p>
    <p>
      In Neukirch, this assumption is called the
      <em>class field axiom</em>.
      (Note that it's not enough just to check cyclic extensions of <m>k</m> itself.)
      Then we will prove the following theorem.
    </p>
    <theorem>
      <title>Reciprocity law</title>
      <statement>
        <p>
          For each finite Galois extension <m>L/K</m> of finite extensions of <m>k</m>,
          there is a canonical isomorphism <m>r_{L/K}: \Gal(L/K)^{\ab} \to A_K / \Norm_{L/K} A_L</m>.
        </p>
      </statement>
    </theorem>
    <p>
      Since we've already checked the class field axiom in the example where <m>k</m> is a local field and <m>A = \kbar^*</m>,
      this immediately recovers the local reciprocity law.
    </p>
    <p>
      Before defining the reciprocity map,
      we verify a consequence of the class field axiom. (Notice the similarities between this argument and what we have done;
      essentially we are running the computation of the cohomology of an unramified extension of local fields in reverse!)
    </p>
    <proposition>
      <statement>
        <p>
          For <m>L/K</m> an unramified extension of finite extensions of <m>k</m> (i.e., <m>e_{L/K} = 1</m>),
          the class field axiom implies that <m>H^i_T(\Gal(L/K), U_L) = 1</m> for <m>i=0, -1</m>.
          Moreover, <m>H^1_T(\Gal(L/K), A_L)</m> is cyclic and is generated by any uniformizer <m>\pi_L</m> for <m>L</m>.
        </p>
      </statement>
    </proposition>
    <proof>
      <p>
        We'll drop <m>\Gal(L/K)</m> from the notation,
        because it's the same group throughout the proof.
        Note that an unramified extension is always Galois and cyclic.
        Consider the short exact sequence <m>0 \to U_L \to A_L \to A_L/U_L \to 0</m>.
        Applying Herbrand quotients, we have <m>h(A_L) = h(U_L) h(A_L/U_L)</m>,
        where <m>h(A_L) = \#H^0_T(A_L)/\#H^{-1}_T(A_L)</m> and so on.
        By the class field axiom, <m>h(A_K) = [L:K]</m>.
        Also, <m>A_L/U_L</m> is isomorphic to
        <m>Z = \im(v)</m> with trivial group action,
        so <m>H^0_T(Z)</m> is cyclic of order <m>[L:K]</m> and
        <m>H^{-1}_T(Z)</m> is trivial. (Recall that
        <m>H^0_T(Z) = Z/\Norm(Z)</m> and <m>H^{-1}_T(Z) = \ker(\Norm)</m>,
        since the action is trivial.) Otherwise put,
        the long exact sequence in Tate groups gives
        <me>
          1 = H^{-1}_T(A_L/U_L) \to H^{0}_T(U_L) \to H^{0}_T(A_L) \to H^{0}_T(A_L/U_L) \to H^{1}_T(U_L) \to H^1_T(A_L) = 1
        </me>
        and the two groups in the middle have the same order,
        so we just have to show that one of the outer groups is trivial,
        and then the middle map will be an isomorphism.
      </p>
      <p>
        Thus it suffices to check that <m>H^{1}_T(U_L) = 1</m>,
        or equivalently <m>H^{-1}_T(U_L) = 1</m>.
        Here is where we use that <m>L/K</m> is unramified, not just cyclic.
        Recall that <m>H^{-1}_T(U_L)</m> consists of elements <m>u</m> of <m>U_L</m> of norm 1, modulo those of the form
        <m>v^\sigma/v</m> for some <m>v \in U_L</m>,
        where <m>\sigma</m> is a generator of <m>\Gal(L/K)</m>.
        By hypothesis, <m>H^{-1}_T(A_L)</m> is trivial,
        so any <m>u \in U_L</m> of norm 1 can be written as
        <m>w^\sigma/w</m> for some <m>w \in A_L</m>.
        Now because <m>L/K</m> is unramified,
        there exists <m>x \in A_K</m> such that <m>w/x \in U_L</m>.
        Now <m>u = v^\sigma/v</m> for <m>v = w/x</m>,
        so <m>u</m> defines the trivial class in <m>H^{-1}_T(U_L)</m>,
        proving the claim.
      </p>
    </proof>
    <corollary xml:id="C_abstract_unramified">
      <statement>
        <p>
          If <m>L/K</m> is unramified, then <m>U_K = \Norm_{L/K} U_L</m>. (Remember,
          this makes sense even if <m>L/K</m> is not finite!)
        </p>
      </statement>
    </corollary>
    <p>
      We now define the reciprocity map <m>r: \Gal(L/K) \to A_K/\Norm_{L/K} A_L</m>;
      as a bonus, this definition will actually give an explicit recipe for computing the reciprocity map in local class field theory.
      For starters, let <m>H</m> be the semigroup of
      <m>g \in \Gal(L^{\unr}/K)</m> such that <m>d_K(g)</m> is a positive integer.
      Define the map <m>r': H \to A_K/\Norm_{L/K} A_{L}</m> as follows.
      For <m>g \in \Gal(L^{\unr}/K)</m>,
      let <m>M</m> be the fixed field of <m>g</m> (so that
      <m>e(M/K) = e((M \cap L)/K)</m> and <m>f(M/K) = d_K(g)</m>),
      and set <m>r'(g) = \Norm_{M/K} (\pi_M)</m> for some uniformizer <m>\pi_M</m>.
      This doesn't depend on the choice of uniformizer:
      if <m>\pi'_M</m> is another one,
      then <m>\pi_M/\pi'_M \in U_L</m> belongs to
      <m>\Norm_{L^{\unr}/L} U_{L^{\unr}}</m> by <xref ref="C_abstract_unramified">Corollary</xref>,
      so <m>\Norm_{M/K} (\pi_M/\pi'_M)</m> belongs to <m>\Norm_{L^{\unr}/K} U_{L^{\unr}} \subseteq \Norm_{L/K} U_L</m>.
      So at least <m>r'</m> is now a well-defined map,
      if not yet a semigroup homomorphism.
    </p>
    <p>
      Let's make some other easy observations about this definition before doing the hard stuff.
      Note that <m>r'</m> is invariant under conjugation:
      if we replace <m>g</m> by <m>h^{-1}gh</m>,
      then its fixed field <m>M</m> is replaced by <m>M^h</m> and we can take the uniformizer <m>\pi_M^h</m>.
      Also, if <m>g \in H</m> is actually in <m>\Gal(L^{\unr}/L)</m>,
      then <m>r'(g) \in \Norm_{L/K} A_L</m>.
      In that case, <m>M</m> contains <m>L</m>,
      so <m>r'(g) = \Norm_{M/K}(\pi_M)</m> can be rewritten as
      <m>\Norm_{L/K} \Norm_{M/L} (\pi_M)</m>, so is clearly a norm.
      That is, if <m>r'</m> were known to be multiplicative,
      it would induce a group homomorphism from
      <m>\Gal(L/K)</m> to <m>A_K/\Norm_{L/K} A_L</m>.
    </p>
    <p>
      Now for the hard part: we have to check that <m>r'</m> is multiplicative.
      Let <m>g_1, g_2 \in H</m> be arbitrary,
      and put <m>g_3 = g_1g_2</m>.
      Let <m>M_i</m> be the fixed field of <m>g_i</m>,
      let <m>\pi_i</m> be a uniformizer of <m>M_i</m>,
      and put <m>\rho_i = r(g_i) = \Norm_{M_i/K}(\pi_i)</m>.
      Again, we want <m>\rho_1\rho_2/\rho_3</m> to be in <m>\Norm_{L^{\unr}/K} A_{L^{\unr}}</m>;
      what makes this hard is that the <m>\rho_i</m> all lie in different fields over <m>K</m>.
      At least one thing is clear:
      <m>v_K(\rho_i) = f(M_i/K) v_{M_i}(\pi_i) = f(M_i/K) = d_K(g_i)</m>,
      so <m>v_K(\rho_1 \rho_2 /\rho_3) = 0</m>.
    </p>
    <p>
      To make progress, we have to push our problem into a single field.
      Choose <m>\phi \in \Gal(L^{\unr}/K)</m> such that <m>d_K(\phi) = 1</m>,
      and put <m>d_i = d_K(g_i)</m>;
      then we can write <m>g_i = \phi^{d_i} h_i</m> for some <m>h_i</m> with <m>d_K(h_i) = 0</m>, that is,
      <m>h_i \in \Gal(L^{\unr}/K^{\unr})</m>.
      Put
      <me>
        \sigma_i = \pi_i \pi_i^\phi \cdots \pi_i^{\phi^{d_i-1}};
      </me>
      then <m>\rho_i = \Norm_{L^{\unr}/K^{\unr}}(\sigma_i)</m>.
    </p>
    <proposition xml:id="prop_norm">
      <statement>
        <p>
          Let <m>M</m> be the fixed field of some
          <m>h \in \Gal(L^{\unr}/K)</m> with <m>d_K(h) = n</m> a positive integer,
          and suppose <m>\phi \in H</m> satisfies <m>d_K(\phi) = 1</m>.
          Then for any <m>x \in A_M</m>,
          <me>
            \Norm_{M/K}(x) = \Norm_{L^{\unr}/K^{\unr}}(x x^\phi \cdots x^{\phi^{n-1}})
          </me>.
        </p>
      </statement>
    </proposition>
    <p>
      Now put <m>u = \sigma_1 \sigma_2/\sigma_3</m>;
      then <m>u \in U_{L^{\unr}}</m> and
      <m>\Norm_{L^{\unr}/K^{\unr}}(u) = \rho_1 \rho_2/\rho_3</m> is the thing we need to be in <m>\Norm_{L/K} U_L</m>.
      Let <m>N</m> be a finite unramified extension of <m>L</m> such that <m>u \in U_N</m>.
      Then <m>\Norm_{L^{\unr}/K^{\unr}}(u) = \Norm_{N/N \cap K^{\unr}}(u)</m>,
      and by the lemma below,
      that implies that <m>u \in \Norm_{N/K} U_N</m> and so <m>u \in \Norm_{L/K}(U_L)</m>.
    </p>
    <lemma>
      <statement>
        <p>
          If <m>M/L</m> and <m>L/K</m> are finite extensions with <m>M/K</m> Galois and <m>L/K</m> unramified,
          and <m>u \in U_M</m> is such that <m>\Norm_{M/L}(u) \in U_K</m>,
          then <m>\Norm_{M/L}(u) \in \Norm_{M/K} U_L</m>.
        </p>
      </statement>
    </lemma>
    <proof>
      <p>
        There is a noncohomological proof in Neukirch (Lemma<nbsp/>IV.5.4),
        but I couldn't follow it, so here's a cohomological argument instead.
        If <m>v = \Norm_{M/L}(u) \in U_K</m>,
        then <m>v</m> represents an element of
        <m>H^0_T(\Gal(M/K), U_M) = U_K/\Norm_{M/K}(U_M)</m> which maps to zero under the map <m>\Res: H^0_T(\Gal(M/K), U_M) \to H^0_T(\Gal(M/L), U_M)</m>.
        By the following lemma,
        <m>v</m> is then in the image of <m>\Inf: H^0_T(\Gal(L/K), U_L) \to H^0_T(\Gal(M/K), U_M)</m>;
        but the former space is zero by <xref ref="C_abstract_unramified">Corollary</xref>!
        Thus <m>v</m> is cohomologous to zero in <m>H^0_T(\Gal(M/K), U_M)</m>;
        that is, <m>v = \Norm_{M/K}(w)</m> for some <m>w \in U_M</m>.
      </p>
    </proof>
    <p>
      This lemma is of course a variant of the inflation-restriction exact sequence;
      we get it from there by dimension shifting.
    </p>
    <lemma>
      <statement>
        <p>
          Let <m>H</m> be a normal subgroup of a finite group <m>G</m> and <m>M</m> a <m>G</m>-module.
          Then the sequence
          <me>
            0 \to H^0_T(G/H, M^H) \stackrel{\Inf}{\to} H^0_T(G,M) \stackrel{\Res}{\to} H^0_T(H,M)
          </me>
          is exact.
        </p>
      </statement>
    </lemma>
    <proof>
      <p>
        Choose <m>N</m> so that <m>0 \to N \to \Ind^G_{1} M \to M \to 0</m> is exact (where again
        <m>\Ind^G_1 M \to M</m> is the map <m>m \otimes [g] \mapsto m^g</m>);
        then by the usual inflation-restriction exact sequence (<xref ref="P_inflation_restriction">Proposition</xref>),
        <me>
          0 \to H^1_T(G/H, N^H) \stackrel{\Inf}{\to} H^1_T(G,N) \stackrel{\Res}{\to} H^1_T(H,N)
        </me>
        is exact.
        Now <m>\Ind^G_{1} M</m> is acyclic for <m>G</m> and for <m>H</m>,
        and <m>(\Ind^G_1 M)^H</m> is acyclic for <m>G/H</m>.
        Moreover, if we take <m>H</m>-invariants, we have an exact sequence
        <me>
          0 \to N^H \to (\Ind^G_1 M)^H \to M^H \to 0;
        </me>
        namely, exactness on the right holds because any
        <m>m \in M^H</m> lifts to <m>m \otimes [1] \in (\Ind^G_1 M)^H</m>.
        Using long exact sequences,
        we may thus shift dimensions to deduce the desired result.
      </p>
    </proof>
    <p>
      Putting everything together,
      we have a semigroup homomorphism
      <m>r': H \to A_K/\Norm_{L/K}A_L</m> which kills <m>\Gal(L^{\unr}/L)</m>.
      Thus <m>r'</m> induces a homomorphism <m>r = r_{L/K}: \Gal(L/K) \to A_K/\Norm_{L/K}A_L</m>.
      We call this the <em>reciprocity map</em>.
      Some straightforward functorialities are left to the reader,
      including the following.
    </p>
    <proposition xml:id="P_abstract_functorialities">
      <statement>
        <p>
          If <m>L/K</m> and <m>L'/K'</m> are finite Galois extensions such that
          <m>K \subseteq K'</m> and <m>L \subseteq L'</m>,
          then the natural map <m>\Gal(L'/K')^{\ab} \to \Gal(L/K)^{\ab}</m> is compatible via the reciprocity map with <m>\Norm_{K'/K}: A_{K'} \to A_K</m>.
          If moreover <m>K' \subseteq L</m>,
          then the natural map <m>A_K \to A_{K'}</m> is compatible with the transfer map <m>\Ver: \Gal(L/K)^{\ab} \to \Gal(L'/K')^{\ab}</m>.
        </p>
      </statement>
    </proposition>
  </subsection>
  <subsection>
    <title>Proof of the reciprocity law</title>
    <p>
      We continue to assume the class field axiom.
      Recall that we want the following result.
    </p>
    <theorem xml:id="T_abstract_reciprocity_law">
      <title>Reciprocity law</title>
      <statement>
        <p>
          For each finite Galois extension <m>L/K</m> of finite extensions of <m>k</m>,
          there is a canonical isomorphism <m>r_{L/K}: \Gal(L/K)^{\ab} \to A_K / \Norm_{L/K} A_L</m>.
        </p>
      </statement>
    </theorem>
    <p>
      From the definition of <m>r</m>,
      it's easy enough to check this for <m>L/K</m> unramified.
    </p>
    <proposition>
      <statement>
        <p>
          If <m>L/K</m> is finite unramified,
          the reciprocity map <m>r_{L/K}</m> sends the Frobenius of
          <m>\Gal(L/K)</m> to a uniformizer of <m>K</m>, and is an isomorphism.
        </p>
      </statement>
    </proposition>
    <proof>
      <p>
        The groups <m>\Gal(L/K)</m> and
        <m>A_K/\Norm_{L/K}(A_L) = H^0_T(\Gal(L/K), A_L)</m> are both cyclic of the same order <m>[L:K]</m>,
        the latter by the class field axiom.
        If <m>g \in \Gal(L/K)</m> is the Frobenius,
        and <m>h \in \Gal(L^{\unr}/K)</m> lifts <m>h</m>,
        then the fixed field of <m>h</m> is just <m>K</m> itself,
        and from the definition of <m>r'</m>,
        <m>r(g) = r'(h)</m> is just a uniformizer of <m>K</m>.
        Since that uniformizer generates <m>H^0(\Gal(L/K), A_L)</m>,
        we conclude <m>r_{L/K}</m> is an isomorphism.
      </p>
    </proof>
    <proposition>
      <statement>
        <p>
          If <m>L/K</m> is finite,
          cyclic and totally ramified (i.e., <m>f_{L/K} = 1</m>),
          then <m>r_{L/K}</m> is an isomorphism.
        </p>
      </statement>
    </proposition>
    <proof>
      <p>
        Since <m>r_{L/K}</m> maps between two groups of the same order by the <m>H^0_T</m> clause of the class field axiom,
        it suffices to show that it is injective.
      </p>
      <p>
        The extension <m>L^{\unr}/K</m> is the compositum of two linearly disjoint extensions <m>L/K</m> and <m>K^{\unr}/K</m>,
        so its Galois group is canonically a product <m>\Gal(L/K) \times \Gal(K^{\unr}/K)</m>.
        Let <m>g</m> be a generator of the first factor and <m>\phi</m> a generator of the second factor.
        Put <m>\tau = g\phi</m>, so that <m>d_K(\tau)=1</m>,
        and let <m>M</m> be the fixed field of <m>\tau</m>.
        Pick uniformizers <m>pi_L</m> and <m>\pi_M</m> of <m>L</m> and <m>M</m>,
        so that <m>r(g) = r'(\tau) = \Norm_{M/K}(\pi_M)</m>.
        Let <m>N</m> be the compositum of <m>L</m> and <m>M</m>.
      </p>
      <p>
        Put <m>n = [L:K]</m>, and suppose
        <m>r(g^j) = \Norm_{M/K}(\pi_M^j)</m> is the identity in <m>A_K/\Norm_{L/K} A_L</m>.
        Since <m>d_K(\tau) = 1</m>,
        we have <m>r(g) = \Norm_{L^{\unr}/K^{\unr}}(\pi_M)</m>.
        On the other hand
        (by <xref ref="prop_norm">Proposition</xref> with <m>n=0</m>!),
        <m>\Norm_{L^{\unr}/K^{\unr}}(\pi_L)</m> is the identity in <m>A_K/\Norm_{L/K} A_L</m>.
        Thus we also have <m>r(g) = \Norm_{L^{\unr}/K^{\unr}}(\pi_M/\pi_L)</m>.
      </p>
      <p>
        Put <m>u = \pi_L^j/\pi_M^j \in U_N</m>.
        If <m>r(g^j)</m> is in <m>\Norm_{L/K} A_L</m>,
        then there exists <m>v \in U_L</m> such that <m>\Norm_{L^{\unr}/K^{\unr}}(v) = \Norm_{L^{\unr}/K^{\unr}}(u)</m>.
        By the <m>H^{-1}_T</m> clause of the class field axiom,
        we can write <m>u/v</m> as <m>a^g/a</m> for some <m>a \in A_N</m>.
        Now
        <me>
          (\pi_L^j/v)^{g-1} = (\pi_L^j/v)^{\tau-1} = (\pi_M^j u/v)^{\tau - 1} = (u/v)^{\tau-1} = (a^\tau/a)^{g-1}
        </me>.
      </p>
      <p>
        If we put <m>x = (\pi_L^j/v)(a/a^\tau)</m>,
        that means <m>x</m> is <m>g</m>-invariant,
        so it belongs to <m>A_{N_0}</m>,
        where <m>N_0 = N \cap K^{\unr}</m>.
        On one hand, that means <m>v_{N_0}(x) \in \widehat{\ZZ}</m>.
        On the other hand, we have <m>nv_{N_0}(x) = v_N(x) = j</m>.
        Thus <m>j</m> is a multiple of <m>n</m>,
        and <m>r</m> must be injective.
      </p>
    </proof>
    <p>
      Now we proceed to the proof of the reciprocity law.
      Any resemblance with the method used to calculate the local invariant map is not coincidental!
    </p>
    <proof>
      <p>
        For reference, we record the following commutative diagram,
        for <m>L/K</m> a finite extension and <m>M</m> an intermediate field:
      </p>
      <image source="images/9160926df3bc8fef7486fa8322cfd7633fc45e01.png"/>
      <p>
        in which the rows are exact.
        We're going to do a lot of diagram-chasing on this picture.
      </p>
      <p>
        First suppose <m>L/K</m> is abelian;
        we induct on <m>[L:K]</m>.
        If <m>L/K</m> is cyclic of prime order,
        then either it is unramified or totally ramified,
        and we already know <m>r_{L/K}</m> is an isomorphism in those cases.
        Otherwise, let <m>M</m> be a subextension of <m>L/K</m>.
        Then chasing the above diagram gives that <m>r_{L/K}</m> is surjective.
        Now the diagram shows that the kernel of <m>r_{L/K}</m> lies in the kernel of <m>\Gal(L/K) \to \Gal(N/K)</m> for <em>every</em>
        proper subextension <m>N</m> of <m>L/K</m>.
        Since <m>L/K</m> is abelian, the intersection of these kernels is trivial.
        Thus <m>r_{L/K}</m> is also injective, so is an isomorphism.
      </p>
      <p>
        Next, suppose <m>L/K</m> is solvable;
        we again induct on <m>[L:K]</m>.
        If <m>L</m> is abelian, we are done.
        If not, let <m>M</m> be the maximal abelian subextension of <m>L/K</m>;
        by the same diagram chase as in the previous paragraph,
        <m>r_{L/K}</m> is surjective.
        Also, we have a diagram
      </p>
      <image source="images/dc708c7eac7a4a65020ef27c170ba4ab06227c20.png"/>
      <p>
        in which the left vertical and bottom horizontal arrows are isomorphisms.
        Thus the composite <m>\Gal(L/K)^{\ab} \to A_K / \Norm_{M/K} A_M</m> is an isomorphism,
        so <m>r_{L/K}</m> must be injective.
        Again, we conclude <m>r_{L/K}</m> is an isomorphism.
      </p>
      <p>
        Finally, let <m>L/K</m> be not solvable.
        The same argument as in the previous paragraph shows that <m>r_{L/K}</m> is injective.
        To show <m>r_{L/K}</m> is surjective,
        let <m>M</m> be the fixed field of a <m>p</m>-Sylow subgroup of <m>\Gal(L/K)</m>.
        Then <m>M/K</m> need not be Galois,
        so the original diagram doesn't actually make sense.
        But the square on the left still commutes,
        and <m>r_{L/M}</m> is an isomorphism by what we already know.
        If we can show the bottom arrow
        <m>\Norm_{M/K}</m> surjects onto the <m>p</m>-Sylow subgroup <m>S_p</m> of <m>A_K/\Norm_{L/K}A_L</m>,
        then the same will be true of <m>r_{L/K}</m>.
        In fact, the inclusion <m>A_K \subseteq A_M</m> induces a homomorphism <m>i: A_K/\Norm_{L/K}A_L \to A_M /\Norm_{L/M} A_L</m> such that
        <m>\Norm_{M/K} \circ i</m> is multiplication by <m>[M:K]</m>,
        which is not divisible by <m>p</m>,
        and so is an isomorphism on <m>S_p</m>.
        Thus <m>\Norm_{M/K}</m> surjects onto <m>S_p</m>, as does <m>r_{L/K}</m>;
        since <m>r_{L/K}</m> surjects onto each <m>p</m>-Sylow subgroup of
        <m>A_K/\Norm_{L/K}A_L</m>, it is in fact surjective.
      </p>
    </proof>
    <p>
      As a bonus byproduct of the proof, we get the following.
    </p>
    <corollary>
      <title>Norm limitation theorem</title>
      <statement>
        <p>
          If <m>M</m> is the maximal abelian subextension of the finite Galois extension <m>L/K</m>,
          then <m>\Norm_{L/K} A_L = \Norm_{M/K} A_M</m>.
        </p>
      </statement>
    </corollary>
  </subsection>
  <subsection>
    <title>A look ahead</title>
    <p>
      What does this tell us about the global Artin reciprocity law?
      If <m>L/K</m> is a finite abelian extension of number fields,
      we are trying to prove that
      <m>\Gal(L/K)</m> is canonically isomorphic to a generalized ideal class group of <m>K</m>.
      So we need to use for <m>A</m> something related to ideal classes.
      You might try taking the group of fractional ideals in <m>L</m>,
      then taking the direct limit over all finite extensions <m>L</m> of <m>K</m>.
      In this case, we would have to find
      <m>H^i(\Gal(L/K), A_L)</m> for <m>A_L</m> the group of fractional ideals in <m>L</m>,
      where <m>L/K</m> is cyclic and <m>i=0, -1</m>.
      Unfortunately, these groups are not so well-behaved as that!
    </p>
    <p>
      The cohomology groups would behave better if <m>A_L</m> were
      <q>complete</q>
      in some sense,
      the way that <m>K^*</m> is complete when <m>K</m> is a local field.
      But there is no good reason to distinguish one place over another in the global case.
      So we're going to make the target group <m>A</m> by
      <q>completing <m>K^*</m> at all places simultaneously</q>.
    </p>
    <p>
      Even without <m>A</m>, I can at least tell you what <m>d</m> is going to be over <m>\QQ</m>.
      To begin with, note that there is a surjective map
      <m>\Gal(\overline{\QQ}/\QQ) \to \Gal(\QQ^{\cyc}/\QQ)</m> that turns an automorphism into its action on roots of unity.
      The latter group is unfortunately isomorphic to the multiplicative group
      <m>\widehat{\ZZ}^*</m> rather than the additive group
      <m>\widehat{\ZZ}</m>, but this is a start.
      To make more progress, write
      <m>\widehat{\ZZ}</m> as the product <m>\prod_p \ZZ_p</m>,
      so that <m>\widehat{\ZZ}^* \cong \prod_p \ZZ_p^*</m>.
      Then recall that there exist isomorphisms
      <me>
        \ZZ_p^* \cong \begin{cases}\ZZ/(p-1)\ZZ \times \ZZ_p \amp  p > 2 \\ \ZZ/2\ZZ \times \ZZ_p \amp  p = 2. \end{cases}
      </me>
    </p>
    <p>
      In particular,
      <m>\ZZ_p^*</m> modulo its torsion subgroup is isomorphic to <m>\ZZ_p</m>,
      but not in a canonical way.
      But never mind about this;
      let us choose an isomorphism for each <m>p</m> and then obtain a surjective map <m>\widehat{\ZZ}^* \to \widehat{\ZZ}</m>.
      Composing, we get a surjective map
      <m>\Gal(\overline{\QQ}/\QQ) \to \widehat{\ZZ}</m> which in principle depends on some choices,
      but the ultimate statements of the theory will be independent of these choices.
      (Note that in this setup, every
      <q>unramified</q>
      extensions of a number field is a subfield of a cyclotomic extension,
      but not conversely.)
    </p>
  </subsection>
  <subsection>
    <title>Exercises</title>
    <ol>
      <li>
        <p>
          Prove <xref ref="P_abstract_functorialities">Proposition</xref>.
        </p>
      </li>
    </ol>
  </subsection>
</section>